CREATE TABLE ITEM_ORDER (
    ITNO NUMBER,
    ODATE DATE,
    OQTY NUMBER
);
CREATE OR REPLACE TRIGGER BIT 
BEFORE
INSERT
ON MPSITTRN
FOR EACH ROW
DECLARE
	VQOH MPSITMST.QOH%TYPE;
    VROL MPSITMST.ROL%TYPE;
    VROQ MPSITMST.ROQ%TYPE;
BEGIN
	SELECT QOH,ROL,ROQ
	INTO VQOH,VROL,VROQ 
	FROM MPSITMST
	WHERE ITNO = :NEW.ITNO;
	IF :NEW.TRANTYPE = 'I' THEN
		UPDATE MPSITMST
        SET QOH = QOH - :NEW.TRANQTY
        WHERE ITNO = :NEW.ITNO;
		
		IF VQOH < VROL THEN
			INSERT INTO ITEM_ORDER VALUES (:NEW.ITNO, SYSDATE, VROQ);
        END IF;
    END IF;
END;
/
/*
CREATE A TRIGGER WHICH HAS BELOW FUNCTIONALITY.

TABLE NAME : MPSITTRN

STATEMENT : INSERT

IF TRANSACTION TYPE IS 'I' (ISSUE), IT SHOULD SUBTRACT TRANQTY FROM QOH COLUMN OF MPSITMST TABLE

FOR THE AFFECTED ITNO.

CREATE A TABLE NAMED : ITEM_ORDER : ITNO , ODATE , OQTY

THE TRIGGER SHOULD CHECK, WHETHER QOH IS LESS THAN ROL. IF IT IS LOWER IT SHOULD INSERT A ROW

IN ITEM_ORDER TABLE FOR THE ITEM WITH ROQ FIXED FOR IT.
*/