CREATE OR REPLACE PACKAGE BODY UPDATE_SAL_PACKAGE
AS
	--FUNCTION VALIDATE_SAL (P_SAL IN MPSEMP.SAL%TYPE,P_EMPNO MPSEMP.EMPNO%TYP) RETURN BOOLEAN;
	FUNCTION VALIDATE_SAL (P_SAL IN MPSEMP.SAL%TYPE,P_EMPNO MPSEMP.EMPNO%TYPE) 
	RETURN BOOLEAN
	IS
		G_MIN_SAL MPSEMP.EMPNO%TYPE;
		G_MAX_SAL MPSEMP.EMPNO%TYPE;
	BEGIN
		SELECT MIN_SALARY , MAX_SALARY INTO G_MIN_SAL,G_MAX_SAL FROM JOBS JOIN MPSEMP ON JOBS.JOB_TITLE = MPSEMP.JOB;
		IF P_SAL BETWEEN G_MIN_SAL AND G_MAX_SAL THEN 
			RETURN(TRUE);
		ELSE
			RETURN(FALSE);
		END IF;
	END VALIDATE_SAL;
	
	PROCEDURE UPDATE_SALARY (P_EMPNO MPSEMP.EMPNO%TYPE, P_SAL IN MPSEMP.SAL%TYPE)
	AS
		V_CURRENT_SAL MPSEMP.SAL%TYPE;  
	BEGIN
		SELECT NVL(SAL,0) INTO V_CURRENT_SAL FROM MPSEMP WHERE EMPNO = P_EMPNO;
		IF P_SAL > V_CURRENT_SAL THEN
			IF VALIDATE_SAL(P_SAL,P_EMPNO) THEN
				UPDATE MPSEMP SET SAL = P_SAL WHERE EMPNO = P_EMPNO;
			ELSE
				RAISE_APPLICATION_ERROR(-20210, 'SALARY NOT BETWEEN RANGE');
			END IF;
		END IF;
	END UPDATE_SALARY;

END UPDATE_SAL_PACKAGE;
/