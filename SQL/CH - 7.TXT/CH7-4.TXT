SQL> 
SQL> CL SCR

SQL> REM DISPLAY THOSE WHO WORKS IN Canada
SQL> 
SQL> SELECT FIRST_NAME
  2  FROM EMPLOYEES
  3  WHERE DEPARTMENT_ID IN (SELECT DEPARTMENT_ID FROM DEPARTMENTS
  4                          WHERE LOCATION_ID IN (SELECT LOCATION_ID FROM LOCATIONS
  5                                                WHERE COUNTRY_ID IN (SELECT COUNTRY_ID FROM COUNTRIES
  6                                                                     WHERE COUNTRY_NAME = 'Canada')));

FIRST_NAME                                                                                                                                                                                              
---------------                                                                                                                                                                                         
Michael                                                                                                                                                                                                 
Pat                                                                                                                                                                                                     

SQL> SELECT * FROM REGIONS;

 REGION_ID REGION_NAME                                                                                                                                                                                  
---------- -------------------------                                                                                                                                                                    
         1 Europe                                                                                                                                                                                       
         2 Americas                                                                                                                                                                                     
         3 Asia                                                                                                                                                                                         
         4 Middle East and Africa                                                                                                                                                                       

SQL> REM DISPLAY THOSE WHO WORKS IN Americas
SQL> 
SQL> SELECT FIRST_NAME
  2  FROM EMPLOYEES
  3  WHERE DEPARTMENT_ID IN (SELECT DEPARTMENT_ID
  4                          FROM DEPARTMENTS
  5                          WHERE LOCATION_ID IN
  6                                               (SELECT LOCATION_ID
  7                                                FROM LOCATIONS
  8                                                WHERE COUNTRY_ID IN
  9                                                                    (SELECT COUNTRY_ID
 10                                                                     FROM COUNTRIES
 11                                                                     WHERE REGION_ID IN (SELECT REGION_ID
 12                                                                                         FROM REGIONS
 13                                                                                         WHERE REGION_NAME = 'Americas'))));

FIRST_NAME                                                                                                                                                                                              
---------------                                                                                                                                                                                         
Jennifer                                                                                                                                                                                                
Michael                                                                                                                                                                                                 
Pat                                                                                                                                                                                                     
Kevin                                                                                                                                                                                                   
Trenna                                                                                                                                                                                                  
Curtis                                                                                                                                                                                                  
Randall                                                                                                                                                                                                 
Peter                                                                                                                                                                                                   
Alexander                                                                                                                                                                                               
Bruce                                                                                                                                                                                                   
Diana                                                                                                                                                                                                   
Steven                                                                                                                                                                                                  
Neena                                                                                                                                                                                                   
Lex                                                                                                                                                                                                     
Shelley                                                                                                                                                                                                 
William                                                                                                                                                                                                 

16 rows selected.

SQL> REM 4 SUB QUERY CAN BE USEFUL WHEN WE WANT TO USE RESULT OF SUB QUERY AS TABLE OF MAIN QUERY.
SQL> 
SQL> REM WHEN WE WANT TO USE PRE-PROCESSED DATA IN OUR MAIN STATEMENT, WE NEED SUB QUERY.
SQL> 
SQL> SELECT FIRST_NAME , JOB_ID , SALARY FROM EMPLOYEES ORDER BY 2,3;

FIRST_NAME      JOB_ID         SALARY                                                                                                                                                                   
--------------- ---------- ----------                                                                                                                                                                   
William         AC_ACCOUNT       8300                                                                                                                                                                   
Shelley         AC_MGR          12000                                                                                                                                                                   
Jennifer        AD_ASST          4400                                                                                                                                                                   
Steven          AD_PRES         24000                                                                                                                                                                   
Lex             AD_VP           17000                                                                                                                                                                   
Neena           AD_VP           17000                                                                                                                                                                   
Diana           IT_PROG          4200                                                                                                                                                                   
Bruce           IT_PROG          6000                                                                                                                                                                   
Alexander       IT_PROG          9000                                                                                                                                                                   
Michael         MK_MAN          13000                                                                                                                                                                   
Pat             MK_REP           6000                                                                                                                                                                   
Eleni           SA_MAN          10500                                                                                                                                                                   
Kimerely        SA_REP           7000                                                                                                                                                                   
Jonathon        SA_REP           8600                                                                                                                                                                   
Ellen           SA_REP          11000                                                                                                                                                                   
Peter           ST_CLERK         2500                                                                                                                                                                   
Randall         ST_CLERK         2600                                                                                                                                                                   
Curtis          ST_CLERK         3100                                                                                                                                                                   
Trenna          ST_CLERK         3500                                                                                                                                                                   
Kevin           ST_MAN           5800                                                                                                                                                                   

20 rows selected.

SQL> SELECT FIRST_NAME , JOB_ID , SALARY , MAX(SALARY) FROM EMPLOYEES ORDER BY 2,3;
SELECT FIRST_NAME , JOB_ID , SALARY , MAX(SALARY) FROM EMPLOYEES ORDER BY 2,3
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT FIRST_NAME , JOB_ID , SALARY , MAX(SALARY) FROM EMPLOYEES GROUP BY JOB_ID ORDER BY 2,3;
SELECT FIRST_NAME , JOB_ID , SALARY , MAX(SALARY) FROM EMPLOYEES GROUP BY JOB_ID ORDER BY 2,3
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT FIRST_NAME , JOB_ID , SALARY , MAX(SALARY) FROM EMPLOYEES GROUP BY FIRST_NAME , JOB_ID , SALARY ORDER BY 2,3;

FIRST_NAME      JOB_ID         SALARY MAX(SALARY)                                                                                                                                                       
--------------- ---------- ---------- -----------                                                                                                                                                       
William         AC_ACCOUNT       8300        8300                                                                                                                                                       
Shelley         AC_MGR          12000       12000                                                                                                                                                       
Jennifer        AD_ASST          4400        4400                                                                                                                                                       
Steven          AD_PRES         24000       24000                                                                                                                                                       
Lex             AD_VP           17000       17000                                                                                                                                                       
Neena           AD_VP           17000       17000                                                                                                                                                       
Diana           IT_PROG          4200        4200                                                                                                                                                       
Bruce           IT_PROG          6000        6000                                                                                                                                                       
Alexander       IT_PROG          9000        9000                                                                                                                                                       
Michael         MK_MAN          13000       13000                                                                                                                                                       
Pat             MK_REP           6000        6000                                                                                                                                                       
Eleni           SA_MAN          10500       10500                                                                                                                                                       
Kimerely        SA_REP           7000        7000                                                                                                                                                       
Jonathon        SA_REP           8600        8600                                                                                                                                                       
Ellen           SA_REP          11000       11000                                                                                                                                                       
Peter           ST_CLERK         2500        2500                                                                                                                                                       
Randall         ST_CLERK         2600        2600                                                                                                                                                       
Curtis          ST_CLERK         3100        3100                                                                                                                                                       
Trenna          ST_CLERK         3500        3500                                                                                                                                                       
Kevin           ST_MAN           5800        5800                                                                                                                                                       

20 rows selected.

SQL> SELECT JOB_ID , MAX(SALARY) FROM EMPLOYEES GROUP BY JOB_ID;

JOB_ID     MAX(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
IT_PROG           9000                                                                                                                                                                                  
AC_MGR           12000                                                                                                                                                                                  
AC_ACCOUNT        8300                                                                                                                                                                                  
ST_MAN            5800                                                                                                                                                                                  
AD_ASST           4400                                                                                                                                                                                  
AD_VP            17000                                                                                                                                                                                  
SA_MAN           10500                                                                                                                                                                                  
MK_MAN           13000                                                                                                                                                                                  
AD_PRES          24000                                                                                                                                                                                  
SA_REP           11000                                                                                                                                                                                  
MK_REP            6000                                                                                                                                                                                  
ST_CLERK          3500                                                                                                                                                                                  

12 rows selected.

SQL> SELECT FIRST_NAME , JOB_ID , SALARY , MAX(SALARY)
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT JOB_ID , MAX(SALARY) FROM EMPLOYEES GROUP BY JOB_ID);
SELECT FIRST_NAME , JOB_ID , SALARY , MAX(SALARY)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT FIRST_NAME , JOB_ID , SALARY , "MAX(SALARY)"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT JOB_ID , MAX(SALARY) FROM EMPLOYEES GROUP BY JOB_ID);

FIRST_NAME      JOB_ID         SALARY MAX(SALARY)                                                                                                                                                       
--------------- ---------- ---------- -----------                                                                                                                                                       
Steven          AD_PRES         24000       24000                                                                                                                                                       
Neena           AD_VP           17000       17000                                                                                                                                                       
Lex             AD_VP           17000       17000                                                                                                                                                       
Alexander       IT_PROG          9000        9000                                                                                                                                                       
Bruce           IT_PROG          6000        9000                                                                                                                                                       
Diana           IT_PROG          4200        9000                                                                                                                                                       
Kevin           ST_MAN           5800        5800                                                                                                                                                       
Trenna          ST_CLERK         3500        3500                                                                                                                                                       
Curtis          ST_CLERK         3100        3500                                                                                                                                                       
Randall         ST_CLERK         2600        3500                                                                                                                                                       
Peter           ST_CLERK         2500        3500                                                                                                                                                       
Eleni           SA_MAN          10500       10500                                                                                                                                                       
Ellen           SA_REP          11000       11000                                                                                                                                                       
Jonathon        SA_REP           8600       11000                                                                                                                                                       
Kimerely        SA_REP           7000       11000                                                                                                                                                       
Jennifer        AD_ASST          4400        4400                                                                                                                                                       
Michael         MK_MAN          13000       13000                                                                                                                                                       
Pat             MK_REP           6000        6000                                                                                                                                                       
Shelley         AC_MGR          12000       12000                                                                                                                                                       
William         AC_ACCOUNT       8300        8300                                                                                                                                                       

20 rows selected.

SQL> SELECT FIRST_NAME , JOB_ID , SALARY , "MAX(SALARY)"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT JOB_ID , max(salary) FROM EMPLOYEES GROUP BY JOB_ID)
  4  
SQL> 
SQL> SELECT JOB_ID , max(salary) FROM EMPLOYEES GROUP BY JOB_ID;

JOB_ID     MAX(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
IT_PROG           9000                                                                                                                                                                                  
AC_MGR           12000                                                                                                                                                                                  
AC_ACCOUNT        8300                                                                                                                                                                                  
ST_MAN            5800                                                                                                                                                                                  
AD_ASST           4400                                                                                                                                                                                  
AD_VP            17000                                                                                                                                                                                  
SA_MAN           10500                                                                                                                                                                                  
MK_MAN           13000                                                                                                                                                                                  
AD_PRES          24000                                                                                                                                                                                  
SA_REP           11000                                                                                                                                                                                  
MK_REP            6000                                                                                                                                                                                  
ST_CLERK          3500                                                                                                                                                                                  

12 rows selected.

SQL> SELECT FIRST_NAME , JOB_ID , SALARY , "max(salary)"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT JOB_ID , max(salary) FROM EMPLOYEES GROUP BY JOB_ID);
SELECT FIRST_NAME , JOB_ID , SALARY , "max(salary)"
                                      *
ERROR at line 1:
ORA-00904: "max(salary)": invalid identifier 


SQL> SELECT FIRST_NAME , JOB_ID , SALARY , MAXSALARY
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT JOB_ID , max(salary) MAXSALARY FROM EMPLOYEES GROUP BY JOB_ID);

FIRST_NAME      JOB_ID         SALARY  MAXSALARY                                                                                                                                                        
--------------- ---------- ---------- ----------                                                                                                                                                        
Steven          AD_PRES         24000      24000                                                                                                                                                        
Neena           AD_VP           17000      17000                                                                                                                                                        
Lex             AD_VP           17000      17000                                                                                                                                                        
Alexander       IT_PROG          9000       9000                                                                                                                                                        
Bruce           IT_PROG          6000       9000                                                                                                                                                        
Diana           IT_PROG          4200       9000                                                                                                                                                        
Kevin           ST_MAN           5800       5800                                                                                                                                                        
Trenna          ST_CLERK         3500       3500                                                                                                                                                        
Curtis          ST_CLERK         3100       3500                                                                                                                                                        
Randall         ST_CLERK         2600       3500                                                                                                                                                        
Peter           ST_CLERK         2500       3500                                                                                                                                                        
Eleni           SA_MAN          10500      10500                                                                                                                                                        
Ellen           SA_REP          11000      11000                                                                                                                                                        
Jonathon        SA_REP           8600      11000                                                                                                                                                        
Kimerely        SA_REP           7000      11000                                                                                                                                                        
Jennifer        AD_ASST          4400       4400                                                                                                                                                        
Michael         MK_MAN          13000      13000                                                                                                                                                        
Pat             MK_REP           6000       6000                                                                                                                                                        
Shelley         AC_MGR          12000      12000                                                                                                                                                        
William         AC_ACCOUNT       8300       8300                                                                                                                                                        

20 rows selected.

SQL> SELECT FIRST_NAME , JOB_ID , SALARY , maxsalaruy
  2  
SQL> SELECT FIRST_NAME , JOB_ID , SALARY , maxsalary
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT JOB_ID , max(salary) MAXSALARY FROM EMPLOYEES GROUP BY JOB_ID);

FIRST_NAME      JOB_ID         SALARY  MAXSALARY                                                                                                                                                        
--------------- ---------- ---------- ----------                                                                                                                                                        
Steven          AD_PRES         24000      24000                                                                                                                                                        
Neena           AD_VP           17000      17000                                                                                                                                                        
Lex             AD_VP           17000      17000                                                                                                                                                        
Alexander       IT_PROG          9000       9000                                                                                                                                                        
Bruce           IT_PROG          6000       9000                                                                                                                                                        
Diana           IT_PROG          4200       9000                                                                                                                                                        
Kevin           ST_MAN           5800       5800                                                                                                                                                        
Trenna          ST_CLERK         3500       3500                                                                                                                                                        
Curtis          ST_CLERK         3100       3500                                                                                                                                                        
Randall         ST_CLERK         2600       3500                                                                                                                                                        
Peter           ST_CLERK         2500       3500                                                                                                                                                        
Eleni           SA_MAN          10500      10500                                                                                                                                                        
Ellen           SA_REP          11000      11000                                                                                                                                                        
Jonathon        SA_REP           8600      11000                                                                                                                                                        
Kimerely        SA_REP           7000      11000                                                                                                                                                        
Jennifer        AD_ASST          4400       4400                                                                                                                                                        
Michael         MK_MAN          13000      13000                                                                                                                                                        
Pat             MK_REP           6000       6000                                                                                                                                                        
Shelley         AC_MGR          12000      12000                                                                                                                                                        
William         AC_ACCOUNT       8300       8300                                                                                                                                                        

20 rows selected.

SQL> SELECT FIRST_NAME , JOB_ID , SALARY , MaxSalary
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT JOB_ID , max(salary) "MaxSalary" FROM EMPLOYEES GROUP BY JOB_ID);
SELECT FIRST_NAME , JOB_ID , SALARY , MaxSalary
                                      *
ERROR at line 1:
ORA-00904: "MAXSALARY": invalid identifier 


SQL> SELECT FIRST_NAME , JOB_ID , SALARY , "MaxSalary"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT JOB_ID , max(salary) "MaxSalary" FROM EMPLOYEES GROUP BY JOB_ID);

FIRST_NAME      JOB_ID         SALARY  MaxSalary                                                                                                                                                        
--------------- ---------- ---------- ----------                                                                                                                                                        
Steven          AD_PRES         24000      24000                                                                                                                                                        
Neena           AD_VP           17000      17000                                                                                                                                                        
Lex             AD_VP           17000      17000                                                                                                                                                        
Alexander       IT_PROG          9000       9000                                                                                                                                                        
Bruce           IT_PROG          6000       9000                                                                                                                                                        
Diana           IT_PROG          4200       9000                                                                                                                                                        
Kevin           ST_MAN           5800       5800                                                                                                                                                        
Trenna          ST_CLERK         3500       3500                                                                                                                                                        
Curtis          ST_CLERK         3100       3500                                                                                                                                                        
Randall         ST_CLERK         2600       3500                                                                                                                                                        
Peter           ST_CLERK         2500       3500                                                                                                                                                        
Eleni           SA_MAN          10500      10500                                                                                                                                                        
Ellen           SA_REP          11000      11000                                                                                                                                                        
Jonathon        SA_REP           8600      11000                                                                                                                                                        
Kimerely        SA_REP           7000      11000                                                                                                                                                        
Jennifer        AD_ASST          4400       4400                                                                                                                                                        
Michael         MK_MAN          13000      13000                                                                                                                                                        
Pat             MK_REP           6000       6000                                                                                                                                                        
Shelley         AC_MGR          12000      12000                                                                                                                                                        
William         AC_ACCOUNT       8300       8300                                                                                                                                                        

20 rows selected.

SQL> SELECT FIRST_NAME , JOB_ID , SALARY , "Max  Salary"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT JOB_ID , max(salary) "Max Salary" FROM EMPLOYEES GROUP BY JOB_ID);
SELECT FIRST_NAME , JOB_ID , SALARY , "Max  Salary"
                                      *
ERROR at line 1:
ORA-00904: "Max  Salary": invalid identifier 


SQL> REM WHEN WE USE CASE SENSITIVE COLUMN ALIAS WE MUST : 1 DELIMIT IT WITH DOUBLE QUOTES 2 USE SAME SPELLING 3 USE SAME CASE 4 USE SAME SPACING
SQL> 
SQL> REM LAST_NAME , DEPARTMENT_ID , SALARY , MIN(SALARY)
SQL> 
SQL> REM 1 WITHOUT COLUMN ALIAS 2 USE CASE INSENSITIVE COLUMN ALIAS 3 USING CASE SENSITIVE COLUMN ALIAS
SQL> 
SQL> SELECT LAST_NAME , DEPARTMENT_ID , SALARY , "MIN(SALARY)"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID)
  4  ORDER BY 2,3;

LAST_NAME       DEPARTMENT_ID     SALARY MIN(SALARY)                                                                                                                                                    
--------------- ------------- ---------- -----------                                                                                                                                                    
Whalen                     10       4400        4400                                                                                                                                                    
Fay                        20       6000        6000                                                                                                                                                    
Hartstein                  20      13000        6000                                                                                                                                                    
Vargas                     50       2500        2500                                                                                                                                                    
Matos                      50       2600        2500                                                                                                                                                    
Davies                     50       3100        2500                                                                                                                                                    
Rajs                       50       3500        2500                                                                                                                                                    
Mourgos                    50       5800        2500                                                                                                                                                    
Lorentz                    60       4200        4200                                                                                                                                                    
Ernst                      60       6000        4200                                                                                                                                                    
Hunold                     60       9000        4200                                                                                                                                                    
Taylor                     80       8600        8600                                                                                                                                                    
Zlotkey                    80      10500        8600                                                                                                                                                    
Abel                       80      11000        8600                                                                                                                                                    
Kochhar                    90      17000       17000                                                                                                                                                    
De Haan                    90      17000       17000                                                                                                                                                    
King                       90      24000       17000                                                                                                                                                    
Gietz                     110       8300        8300                                                                                                                                                    
Higgins                   110      12000        8300                                                                                                                                                    

19 rows selected.

SQL> SELECT LAST_NAME , DEPARTMENT_ID , SALARY , MINSALARY
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) minsalary FROM EMPLOYEES GROUP BY DEPARTMENT_ID)
  4  ORDER BY 2,3;

LAST_NAME       DEPARTMENT_ID     SALARY  MINSALARY                                                                                                                                                     
--------------- ------------- ---------- ----------                                                                                                                                                     
Whalen                     10       4400       4400                                                                                                                                                     
Fay                        20       6000       6000                                                                                                                                                     
Hartstein                  20      13000       6000                                                                                                                                                     
Vargas                     50       2500       2500                                                                                                                                                     
Matos                      50       2600       2500                                                                                                                                                     
Davies                     50       3100       2500                                                                                                                                                     
Rajs                       50       3500       2500                                                                                                                                                     
Mourgos                    50       5800       2500                                                                                                                                                     
Lorentz                    60       4200       4200                                                                                                                                                     
Ernst                      60       6000       4200                                                                                                                                                     
Hunold                     60       9000       4200                                                                                                                                                     
Taylor                     80       8600       8600                                                                                                                                                     
Zlotkey                    80      10500       8600                                                                                                                                                     
Abel                       80      11000       8600                                                                                                                                                     
Kochhar                    90      17000      17000                                                                                                                                                     
De Haan                    90      17000      17000                                                                                                                                                     
King                       90      24000      17000                                                                                                                                                     
Gietz                     110       8300       8300                                                                                                                                                     
Higgins                   110      12000       8300                                                                                                                                                     

19 rows selected.

SQL> SELECT LAST_NAME , DEPARTMENT_ID , SALARY , "Min Salary"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) "Min Salary" FROM EMPLOYEES GROUP BY DEPARTMENT_ID)
  4  ORDER BY 2,3;

LAST_NAME       DEPARTMENT_ID     SALARY Min Salary                                                                                                                                                     
--------------- ------------- ---------- ----------                                                                                                                                                     
Whalen                     10       4400       4400                                                                                                                                                     
Fay                        20       6000       6000                                                                                                                                                     
Hartstein                  20      13000       6000                                                                                                                                                     
Vargas                     50       2500       2500                                                                                                                                                     
Matos                      50       2600       2500                                                                                                                                                     
Davies                     50       3100       2500                                                                                                                                                     
Rajs                       50       3500       2500                                                                                                                                                     
Mourgos                    50       5800       2500                                                                                                                                                     
Lorentz                    60       4200       4200                                                                                                                                                     
Ernst                      60       6000       4200                                                                                                                                                     
Hunold                     60       9000       4200                                                                                                                                                     
Taylor                     80       8600       8600                                                                                                                                                     
Zlotkey                    80      10500       8600                                                                                                                                                     
Abel                       80      11000       8600                                                                                                                                                     
Kochhar                    90      17000      17000                                                                                                                                                     
De Haan                    90      17000      17000                                                                                                                                                     
King                       90      24000      17000                                                                                                                                                     
Gietz                     110       8300       8300                                                                                                                                                     
Higgins                   110      12000       8300                                                                                                                                                     

19 rows selected.

SQL> REM DISPLAY FIRST_NAME , MANAGER_ID , SALARY , AVERAGESALARY
SQL> 
SQL> SELECT FIRST_NAME , MANAGER_ID , SALARY , AVG(SALARY) AVERAGESALARY
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT MANAGER_ID , AVG(SALARY) AVERAGESALARY FROM EMPLOYEES GROUP BY MANAGER_ID);
SELECT FIRST_NAME , MANAGER_ID , SALARY , AVG(SALARY) AVERAGESALARY
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT FIRST_NAME , MANAGER_ID , SALARY , "AVG(SALARY)"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT MANAGER_ID , AVG(SALARY) FROM EMPLOYEES GROUP BY MANAGER_ID);

FIRST_NAME      MANAGER_ID     SALARY AVG(SALARY)                                                                                                                                                       
--------------- ---------- ---------- -----------                                                                                                                                                       
Neena                  100      17000       12660                                                                                                                                                       
Lex                    100      17000       12660                                                                                                                                                       
Alexander              102       9000        9000                                                                                                                                                       
Bruce                  103       6000        5100                                                                                                                                                       
Diana                  103       4200        5100                                                                                                                                                       
Kevin                  100       5800       12660                                                                                                                                                       
Trenna                 124       3500        2925                                                                                                                                                       
Curtis                 124       3100        2925                                                                                                                                                       
Randall                124       2600        2925                                                                                                                                                       
Peter                  124       2500        2925                                                                                                                                                       
Eleni                  100      10500       12660                                                                                                                                                       
Ellen                  149      11000  8866.66667                                                                                                                                                       
Jonathon               149       8600  8866.66667                                                                                                                                                       
Kimerely               149       7000  8866.66667                                                                                                                                                       
Jennifer               101       4400        8200                                                                                                                                                       
Michael                100      13000       12660                                                                                                                                                       
Pat                    201       6000        6000                                                                                                                                                       
Shelley                101      12000        8200                                                                                                                                                       
William                205       8300        8300                                                                                                                                                       

19 rows selected.

SQL> SELECT FIRST_NAME , MANAGER_ID , SALARY , "AVG(SALARY)"
  2  FROM EMPLOYEES
  3  JOIN (SELECT MANAGER_ID , AVG(SALARY) FROM EMPLOYEES GROUP BY MANAGER_ID) USING (MANAGER_ID);

FIRST_NAME      MANAGER_ID     SALARY AVG(SALARY)                                                                                                                                                       
--------------- ---------- ---------- -----------                                                                                                                                                       
Neena                  100      17000       12660                                                                                                                                                       
Lex                    100      17000       12660                                                                                                                                                       
Alexander              102       9000        9000                                                                                                                                                       
Bruce                  103       6000        5100                                                                                                                                                       
Diana                  103       4200        5100                                                                                                                                                       
Kevin                  100       5800       12660                                                                                                                                                       
Trenna                 124       3500        2925                                                                                                                                                       
Curtis                 124       3100        2925                                                                                                                                                       
Randall                124       2600        2925                                                                                                                                                       
Peter                  124       2500        2925                                                                                                                                                       
Eleni                  100      10500       12660                                                                                                                                                       
Ellen                  149      11000  8866.66667                                                                                                                                                       
Jonathon               149       8600  8866.66667                                                                                                                                                       
Kimerely               149       7000  8866.66667                                                                                                                                                       
Jennifer               101       4400        8200                                                                                                                                                       
Michael                100      13000       12660                                                                                                                                                       
Pat                    201       6000        6000                                                                                                                                                       
Shelley                101      12000        8200                                                                                                                                                       
William                205       8300        8300                                                                                                                                                       

19 rows selected.

SQL> REM FULLNAME , DEPARTMENT_ID , SALARY , DEPT_MIN_SAL , JOB_ID , JOB_MAX_SAL
SQL> 
SQL> REM 1 NATURAL JOIN 2 INNER JOIN USING
SQL> 
SQL> SELECT FIRST_NAME || ' ' || LAST_NAME FULLNAME , DEPARTMENT_ID , SALARY , DEPT_MIN_SAL , JOB_ID , JOB_MAX_SAL
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) DEPT_MIN_SAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID)
  4  NATURAL JOIN (SELECT JOB_ID , MAX(SALARY) JOB_MAX_SAL FROM EMPLOYEES GROUP BY JOB_ID);

FULLNAME                        DEPARTMENT_ID     SALARY DEPT_MIN_SAL JOB_ID     JOB_MAX_SAL                                                                                                            
------------------------------- ------------- ---------- ------------ ---------- -----------                                                                                                            
Alexander Hunold                           60       9000         4200 IT_PROG           9000                                                                                                            
Bruce Ernst                                60       6000         4200 IT_PROG           9000                                                                                                            
Diana Lorentz                              60       4200         4200 IT_PROG           9000                                                                                                            
Shelley Higgins                           110      12000         8300 AC_MGR           12000                                                                                                            
William Gietz                             110       8300         8300 AC_ACCOUNT        8300                                                                                                            
Kevin Mourgos                              50       5800         2500 ST_MAN            5800                                                                                                            
Jennifer Whalen                            10       4400         4400 AD_ASST           4400                                                                                                            
Neena Kochhar                              90      17000        17000 AD_VP            17000                                                                                                            
Lex De Haan                                90      17000        17000 AD_VP            17000                                                                                                            
Eleni Zlotkey                              80      10500         8600 SA_MAN           10500                                                                                                            
Michael Hartstein                          20      13000         6000 MK_MAN           13000                                                                                                            
Steven King                                90      24000        17000 AD_PRES          24000                                                                                                            
Ellen Abel                                 80      11000         8600 SA_REP           11000                                                                                                            
Jonathon Taylor                            80       8600         8600 SA_REP           11000                                                                                                            
Pat Fay                                    20       6000         6000 MK_REP            6000                                                                                                            
Trenna Rajs                                50       3500         2500 ST_CLERK          3500                                                                                                            
Curtis Davies                              50       3100         2500 ST_CLERK          3500                                                                                                            
Randall Matos                              50       2600         2500 ST_CLERK          3500                                                                                                            
Peter Vargas                               50       2500         2500 ST_CLERK          3500                                                                                                            

19 rows selected.

SQL> SELECT FIRST_NAME || ' ' || LAST_NAME FULLNAME , DEPARTMENT_ID , SALARY , DEPT_MIN_SAL , JOB_ID , JOB_MAX_SAL
  2  FROM EMPLOYEES
  3  JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) DEPT_MIN_SAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID) USING (DEPARTMENT_ID)
  4  JOIN (SELECT JOB_ID , MAX(SALARY) JOB_MAX_SAL FROM EMPLOYEES GROUP BY JOB_ID) USING (JOB_ID);

FULLNAME                        DEPARTMENT_ID     SALARY DEPT_MIN_SAL JOB_ID     JOB_MAX_SAL                                                                                                            
------------------------------- ------------- ---------- ------------ ---------- -----------                                                                                                            
Alexander Hunold                           60       9000         4200 IT_PROG           9000                                                                                                            
Bruce Ernst                                60       6000         4200 IT_PROG           9000                                                                                                            
Diana Lorentz                              60       4200         4200 IT_PROG           9000                                                                                                            
Shelley Higgins                           110      12000         8300 AC_MGR           12000                                                                                                            
William Gietz                             110       8300         8300 AC_ACCOUNT        8300                                                                                                            
Kevin Mourgos                              50       5800         2500 ST_MAN            5800                                                                                                            
Jennifer Whalen                            10       4400         4400 AD_ASST           4400                                                                                                            
Neena Kochhar                              90      17000        17000 AD_VP            17000                                                                                                            
Lex De Haan                                90      17000        17000 AD_VP            17000                                                                                                            
Eleni Zlotkey                              80      10500         8600 SA_MAN           10500                                                                                                            
Michael Hartstein                          20      13000         6000 MK_MAN           13000                                                                                                            
Steven King                                90      24000        17000 AD_PRES          24000                                                                                                            
Ellen Abel                                 80      11000         8600 SA_REP           11000                                                                                                            
Jonathon Taylor                            80       8600         8600 SA_REP           11000                                                                                                            
Pat Fay                                    20       6000         6000 MK_REP            6000                                                                                                            
Trenna Rajs                                50       3500         2500 ST_CLERK          3500                                                                                                            
Curtis Davies                              50       3100         2500 ST_CLERK          3500                                                                                                            
Randall Matos                              50       2600         2500 ST_CLERK          3500                                                                                                            
Peter Vargas                               50       2500         2500 ST_CLERK          3500                                                                                                            

19 rows selected.

SQL> REM FIRST_NAME , MANAGER_ID , SALARY , MGR_AVG_SAL , MGR_SUM_SAL
SQL> 
SQL> 
SQL> SELECT FIRST_NAME , MANAGER_ID , SALARY , MGR_AVG_SAL , MGR_SUM_SAL
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT MANAGER_ID , AVG(SALARY) MGR_AVG_SAL , SUM(SALARY) MGR_SUM_SAL FROM EMPLOYEES GROUP BY MANAGER_ID);

FIRST_NAME      MANAGER_ID     SALARY MGR_AVG_SAL MGR_SUM_SAL                                                                                                                                           
--------------- ---------- ---------- ----------- -----------                                                                                                                                           
Neena                  100      17000       12660       63300                                                                                                                                           
Lex                    100      17000       12660       63300                                                                                                                                           
Alexander              102       9000        9000        9000                                                                                                                                           
Bruce                  103       6000        5100       10200                                                                                                                                           
Diana                  103       4200        5100       10200                                                                                                                                           
Kevin                  100       5800       12660       63300                                                                                                                                           
Trenna                 124       3500        2925       11700                                                                                                                                           
Curtis                 124       3100        2925       11700                                                                                                                                           
Randall                124       2600        2925       11700                                                                                                                                           
Peter                  124       2500        2925       11700                                                                                                                                           
Eleni                  100      10500       12660       63300                                                                                                                                           
Ellen                  149      11000  8866.66667       26600                                                                                                                                           
Jonathon               149       8600  8866.66667       26600                                                                                                                                           
Kimerely               149       7000  8866.66667       26600                                                                                                                                           
Jennifer               101       4400        8200       16400                                                                                                                                           
Michael                100      13000       12660       63300                                                                                                                                           
Pat                    201       6000        6000        6000                                                                                                                                           
Shelley                101      12000        8200       16400                                                                                                                                           
William                205       8300        8300        8300                                                                                                                                           

19 rows selected.

SQL> SELECT FIRST_NAME , MANAGER_ID , SALARY , MGR_AVG_SAL , MGR_SUM_SAL
  2  FROM EMPLOYEES
  3  JOIN (SELECT MANAGER_ID , AVG(SALARY) MGR_AVG_SAL , SUM(SALARY) MGR_SUM_SAL FROM EMPLOYEES GROUP BY MANAGER_ID) USING (MANAGER_ID);

FIRST_NAME      MANAGER_ID     SALARY MGR_AVG_SAL MGR_SUM_SAL                                                                                                                                           
--------------- ---------- ---------- ----------- -----------                                                                                                                                           
Neena                  100      17000       12660       63300                                                                                                                                           
Lex                    100      17000       12660       63300                                                                                                                                           
Alexander              102       9000        9000        9000                                                                                                                                           
Bruce                  103       6000        5100       10200                                                                                                                                           
Diana                  103       4200        5100       10200                                                                                                                                           
Kevin                  100       5800       12660       63300                                                                                                                                           
Trenna                 124       3500        2925       11700                                                                                                                                           
Curtis                 124       3100        2925       11700                                                                                                                                           
Randall                124       2600        2925       11700                                                                                                                                           
Peter                  124       2500        2925       11700                                                                                                                                           
Eleni                  100      10500       12660       63300                                                                                                                                           
Ellen                  149      11000  8866.66667       26600                                                                                                                                           
Jonathon               149       8600  8866.66667       26600                                                                                                                                           
Kimerely               149       7000  8866.66667       26600                                                                                                                                           
Jennifer               101       4400        8200       16400                                                                                                                                           
Michael                100      13000       12660       63300                                                                                                                                           
Pat                    201       6000        6000        6000                                                                                                                                           
Shelley                101      12000        8200       16400                                                                                                                                           
William                205       8300        8300        8300                                                                                                                                           

19 rows selected.

SQL> SELECT FIRST_NAME , MANAGER_ID , SALARY , MGR_AVG_SAL , MGR_SUM_SAL
  2  FROM EMPLOYEES
  3  JOIN (SELECT MANAGER_ID , AVG(SALARY) MGR_AVG_SAL , SUM(SALARY) MGR_SUM_SAL FROM EMPLOYEES GROUP BY MANAGER_ID) ON MANAGER_ID = MANAGER_ID;
JOIN (SELECT MANAGER_ID , AVG(SALARY) MGR_AVG_SAL , SUM(SALARY) MGR_SUM_SAL FROM EMPLOYEES GROUP BY MANAGER_ID) ON MANAGER_ID = MANAGER_ID
                                                                                                                                *
ERROR at line 3:
ORA-00918: column ambiguously defined 


SQL> SELECT FIRST_NAME , MANAGER_ID , SALARY , MGR_AVG_SAL , MGR_SUM_SAL
  2  FROM EMPLOYEES E
  3  JOIN (SELECT MANAGER_ID , AVG(SALARY) MGR_AVG_SAL , SUM(SALARY) MGR_SUM_SAL FROM EMPLOYEES GROUP BY MANAGER_ID) ON E.MANAGER_ID = MANAGER_ID;
JOIN (SELECT MANAGER_ID , AVG(SALARY) MGR_AVG_SAL , SUM(SALARY) MGR_SUM_SAL FROM EMPLOYEES GROUP BY MANAGER_ID) ON E.MANAGER_ID = MANAGER_ID
                                                                                                                                  *
ERROR at line 3:
ORA-00918: column ambiguously defined 


SQL> SELECT FIRST_NAME , MANAGER_ID , SALARY , MGR_AVG_SAL , MGR_SUM_SAL
  2  FROM EMPLOYEES E
  3  JOIN (SELECT MANAGER_ID , AVG(SALARY) MGR_AVG_SAL , SUM(SALARY) MGR_SUM_SAL FROM EMPLOYEES M GROUP BY MANAGER_ID) ON E.MANAGER_ID = M.MANAGER_ID;
JOIN (SELECT MANAGER_ID , AVG(SALARY) MGR_AVG_SAL , SUM(SALARY) MGR_SUM_SAL FROM EMPLOYEES M GROUP BY MANAGER_ID) ON E.MANAGER_ID = M.MANAGER_ID
                                                                                                                                    *
ERROR at line 3:
ORA-00904: "M"."MANAGER_ID": invalid identifier 


SQL> SELECT FIRST_NAME , MANAGER_ID , SALARY , MGR_AVG_SAL , MGR_SUM_SAL
  2  FROM EMPLOYEES E
  3  JOIN (SELECT MANAGER_ID , AVG(SALARY) MGR_AVG_SAL , SUM(SALARY) MGR_SUM_SAL FROM EMPLOYEES GROUP BY MANAGER_ID) M ON E.MANAGER_ID = M.MANAGER_ID;
SELECT FIRST_NAME , MANAGER_ID , SALARY , MGR_AVG_SAL , MGR_SUM_SAL
                    *
ERROR at line 1:
ORA-00918: column ambiguously defined 


SQL> SELECT FIRST_NAME , E.MANAGER_ID , SALARY , MGR_AVG_SAL , MGR_SUM_SAL
  2  FROM EMPLOYEES E
  3  JOIN (SELECT MANAGER_ID , AVG(SALARY) MGR_AVG_SAL , SUM(SALARY) MGR_SUM_SAL FROM EMPLOYEES GROUP BY MANAGER_ID) M ON E.MANAGER_ID = M.MANAGER_ID;

FIRST_NAME      MANAGER_ID     SALARY MGR_AVG_SAL MGR_SUM_SAL                                                                                                                                           
--------------- ---------- ---------- ----------- -----------                                                                                                                                           
Neena                  100      17000       12660       63300                                                                                                                                           
Lex                    100      17000       12660       63300                                                                                                                                           
Alexander              102       9000        9000        9000                                                                                                                                           
Bruce                  103       6000        5100       10200                                                                                                                                           
Diana                  103       4200        5100       10200                                                                                                                                           
Kevin                  100       5800       12660       63300                                                                                                                                           
Trenna                 124       3500        2925       11700                                                                                                                                           
Curtis                 124       3100        2925       11700                                                                                                                                           
Randall                124       2600        2925       11700                                                                                                                                           
Peter                  124       2500        2925       11700                                                                                                                                           
Eleni                  100      10500       12660       63300                                                                                                                                           
Ellen                  149      11000  8866.66667       26600                                                                                                                                           
Jonathon               149       8600  8866.66667       26600                                                                                                                                           
Kimerely               149       7000  8866.66667       26600                                                                                                                                           
Jennifer               101       4400        8200       16400                                                                                                                                           
Michael                100      13000       12660       63300                                                                                                                                           
Pat                    201       6000        6000        6000                                                                                                                                           
Shelley                101      12000        8200       16400                                                                                                                                           
William                205       8300        8300        8300                                                                                                                                           

19 rows selected.

SQL> REM FIRST_NAME , DEPARTMENT_ID , SALARY , DEPT_MIN_SAL , DIFFERENCE
SQL> 
SQL> REM 1 NATURAL JOIN WITHOUT COLUMN ALIAS
SQL> 
SQL> REM 2 INNER JOIN USING : CASE INSENSITIVE COLUMN ALIAS
SQL> 
SQL> REM 3 INNER JOIN ON : CASE SENSITIVE COLUMN ALIAS
SQL> 
SQL> SELECT  FIRST_NAME , DEPARTMENT_ID , SALARY , "MIN(SALARY)" , "MIN(SALARY)" - SALARY DIFFERENCE
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME      DEPARTMENT_ID     SALARY MIN(SALARY) DIFFERENCE                                                                                                                                         
--------------- ------------- ---------- ----------- ----------                                                                                                                                         
Steven                     90      24000       17000      -7000                                                                                                                                         
Neena                      90      17000       17000          0                                                                                                                                         
Lex                        90      17000       17000          0                                                                                                                                         
Alexander                  60       9000        4200      -4800                                                                                                                                         
Bruce                      60       6000        4200      -1800                                                                                                                                         
Diana                      60       4200        4200          0                                                                                                                                         
Kevin                      50       5800        2500      -3300                                                                                                                                         
Trenna                     50       3500        2500      -1000                                                                                                                                         
Curtis                     50       3100        2500       -600                                                                                                                                         
Randall                    50       2600        2500       -100                                                                                                                                         
Peter                      50       2500        2500          0                                                                                                                                         
Eleni                      80      10500        8600      -1900                                                                                                                                         
Ellen                      80      11000        8600      -2400                                                                                                                                         
Jonathon                   80       8600        8600          0                                                                                                                                         
Jennifer                   10       4400        4400          0                                                                                                                                         
Michael                    20      13000        6000      -7000                                                                                                                                         
Pat                        20       6000        6000          0                                                                                                                                         
Shelley                   110      12000        8300      -3700                                                                                                                                         
William                   110       8300        8300          0                                                                                                                                         

19 rows selected.

SQL> REM 2 INNER JOIN USING : CASE INSENSITIVE COLUMN ALIAS
SQL> 
SQL> SELECT  FIRST_NAME , DEPARTMENT_ID , SALARY , MINSALARY , MINSALARY - SALARY DIFFERENCE
  2  FROM EMPLOYEES
  3  JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID) USING (DEPARTMENT_ID);
SELECT  FIRST_NAME , DEPARTMENT_ID , SALARY , MINSALARY , MINSALARY - SALARY DIFFERENCE
                                                          *
ERROR at line 1:
ORA-00904: "MINSALARY": invalid identifier 


SQL> SELECT  FIRST_NAME , DEPARTMENT_ID , SALARY , MINSALARY , MINSALARY - SALARY DIFFERENCE
  2  FROM EMPLOYEES
  3  JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) MINSALARY FROM EMPLOYEES GROUP BY DEPARTMENT_ID) USING (DEPARTMENT_ID);

FIRST_NAME      DEPARTMENT_ID     SALARY  MINSALARY DIFFERENCE                                                                                                                                          
--------------- ------------- ---------- ---------- ----------                                                                                                                                          
Steven                     90      24000      17000      -7000                                                                                                                                          
Neena                      90      17000      17000          0                                                                                                                                          
Lex                        90      17000      17000          0                                                                                                                                          
Alexander                  60       9000       4200      -4800                                                                                                                                          
Bruce                      60       6000       4200      -1800                                                                                                                                          
Diana                      60       4200       4200          0                                                                                                                                          
Kevin                      50       5800       2500      -3300                                                                                                                                          
Trenna                     50       3500       2500      -1000                                                                                                                                          
Curtis                     50       3100       2500       -600                                                                                                                                          
Randall                    50       2600       2500       -100                                                                                                                                          
Peter                      50       2500       2500          0                                                                                                                                          
Eleni                      80      10500       8600      -1900                                                                                                                                          
Ellen                      80      11000       8600      -2400                                                                                                                                          
Jonathon                   80       8600       8600          0                                                                                                                                          
Jennifer                   10       4400       4400          0                                                                                                                                          
Michael                    20      13000       6000      -7000                                                                                                                                          
Pat                        20       6000       6000          0                                                                                                                                          
Shelley                   110      12000       8300      -3700                                                                                                                                          
William                   110       8300       8300          0                                                                                                                                          

19 rows selected.

SQL> SELECT  FIRST_NAME , DEPARTMENT_ID , SALARY , "MIN(SALARY)" , SALARY - "MIN(SALARY)" DIFFERENCE
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME      DEPARTMENT_ID     SALARY MIN(SALARY) DIFFERENCE                                                                                                                                         
--------------- ------------- ---------- ----------- ----------                                                                                                                                         
Steven                     90      24000       17000       7000                                                                                                                                         
Neena                      90      17000       17000          0                                                                                                                                         
Lex                        90      17000       17000          0                                                                                                                                         
Alexander                  60       9000        4200       4800                                                                                                                                         
Bruce                      60       6000        4200       1800                                                                                                                                         
Diana                      60       4200        4200          0                                                                                                                                         
Kevin                      50       5800        2500       3300                                                                                                                                         
Trenna                     50       3500        2500       1000                                                                                                                                         
Curtis                     50       3100        2500        600                                                                                                                                         
Randall                    50       2600        2500        100                                                                                                                                         
Peter                      50       2500        2500          0                                                                                                                                         
Eleni                      80      10500        8600       1900                                                                                                                                         
Ellen                      80      11000        8600       2400                                                                                                                                         
Jonathon                   80       8600        8600          0                                                                                                                                         
Jennifer                   10       4400        4400          0                                                                                                                                         
Michael                    20      13000        6000       7000                                                                                                                                         
Pat                        20       6000        6000          0                                                                                                                                         
Shelley                   110      12000        8300       3700                                                                                                                                         
William                   110       8300        8300          0                                                                                                                                         

19 rows selected.

SQL> SELECT  FIRST_NAME , DEPARTMENT_ID , SALARY , MINSALARY , SALARY - MINSALARY DIFFERENCE
  2  FROM EMPLOYEES
  3  JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) MINSALARY FROM EMPLOYEES GROUP BY DEPARTMENT_ID) USING (DEPARTMENT_ID);

FIRST_NAME      DEPARTMENT_ID     SALARY  MINSALARY DIFFERENCE                                                                                                                                          
--------------- ------------- ---------- ---------- ----------                                                                                                                                          
Steven                     90      24000      17000       7000                                                                                                                                          
Neena                      90      17000      17000          0                                                                                                                                          
Lex                        90      17000      17000          0                                                                                                                                          
Alexander                  60       9000       4200       4800                                                                                                                                          
Bruce                      60       6000       4200       1800                                                                                                                                          
Diana                      60       4200       4200          0                                                                                                                                          
Kevin                      50       5800       2500       3300                                                                                                                                          
Trenna                     50       3500       2500       1000                                                                                                                                          
Curtis                     50       3100       2500        600                                                                                                                                          
Randall                    50       2600       2500        100                                                                                                                                          
Peter                      50       2500       2500          0                                                                                                                                          
Eleni                      80      10500       8600       1900                                                                                                                                          
Ellen                      80      11000       8600       2400                                                                                                                                          
Jonathon                   80       8600       8600          0                                                                                                                                          
Jennifer                   10       4400       4400          0                                                                                                                                          
Michael                    20      13000       6000       7000                                                                                                                                          
Pat                        20       6000       6000          0                                                                                                                                          
Shelley                   110      12000       8300       3700                                                                                                                                          
William                   110       8300       8300          0                                                                                                                                          

19 rows selected.

SQL> SELECT  FIRST_NAME , DEPARTMENT_ID , SALARY , "Min Salary" , SALARY - "Min Salary" DIFFERENCE
  2  FROM EMPLOYEES
  3  
SQL> 
SQL> SELECT  FIRST_NAME , DEPARTMENT_ID , SALARY , MINSALARY , SALARY - MINSALARY DIFFERENCE
  2  
SQL> 
SQL> SELECT  FIRST_NAME , DEPARTMENT_ID , SALARY , "Min Salary" , SALARY - "Min Salary" DIFFERENCE
  2  FROM EMPLOYEES E
  3  JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) "Min Salary" FROM EMPLOYEES GROUP BY DEPARTMENT_ID) D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
  4  
SQL> SELECT  FIRST_NAME , E.DEPARTMENT_ID , SALARY , "Min Salary" , SALARY - "Min Salary" DIFFERENCE
  2  FROM EMPLOYEES E
  3  JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) "Min Salary" FROM EMPLOYEES GROUP BY DEPARTMENT_ID) D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID;

FIRST_NAME      DEPARTMENT_ID     SALARY Min Salary DIFFERENCE                                                                                                                                          
--------------- ------------- ---------- ---------- ----------                                                                                                                                          
Steven                     90      24000      17000       7000                                                                                                                                          
Neena                      90      17000      17000          0                                                                                                                                          
Lex                        90      17000      17000          0                                                                                                                                          
Alexander                  60       9000       4200       4800                                                                                                                                          
Bruce                      60       6000       4200       1800                                                                                                                                          
Diana                      60       4200       4200          0                                                                                                                                          
Kevin                      50       5800       2500       3300                                                                                                                                          
Trenna                     50       3500       2500       1000                                                                                                                                          
Curtis                     50       3100       2500        600                                                                                                                                          
Randall                    50       2600       2500        100                                                                                                                                          
Peter                      50       2500       2500          0                                                                                                                                          
Eleni                      80      10500       8600       1900                                                                                                                                          
Ellen                      80      11000       8600       2400                                                                                                                                          
Jonathon                   80       8600       8600          0                                                                                                                                          
Jennifer                   10       4400       4400          0                                                                                                                                          
Michael                    20      13000       6000       7000                                                                                                                                          
Pat                        20       6000       6000          0                                                                                                                                          
Shelley                   110      12000       8300       3700                                                                                                                                          
William                   110       8300       8300          0                                                                                                                                          

19 rows selected.

SQL> REM FIRST_NAME , HIRE_YEAR , SALARY , HIRE_YEAR_MAX_SALARY
SQL> 
SQL> SELECT FIRST_NAME , TO_CHAR(HIRE_DATE,'RRRR') , SALARY , HIRE_YEAR_MAX_SALARY
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT TO_CHAR(HIRE_DATE,'RRRR') , MAX(SALARY) HIRE_YEAR_MAX_SALARY FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'RRRR'));

FIRST_NAME      TO_C     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Steven          1987      24000                24000                                                                                                                                                    
Neena           1989      17000                24000                                                                                                                                                    
Lex             1993      17000                24000                                                                                                                                                    
Alexander       1990       9000                24000                                                                                                                                                    
Bruce           1991       6000                24000                                                                                                                                                    
Diana           1999       4200                24000                                                                                                                                                    
Kevin           1999       5800                24000                                                                                                                                                    
Trenna          1995       3500                24000                                                                                                                                                    
Curtis          1997       3100                24000                                                                                                                                                    
Randall         1998       2600                24000                                                                                                                                                    
Peter           1998       2500                24000                                                                                                                                                    
Eleni           2000      10500                24000                                                                                                                                                    
Ellen           1996      11000                24000                                                                                                                                                    
Jonathon        1998       8600                24000                                                                                                                                                    
Kimerely        1999       7000                24000                                                                                                                                                    
Jennifer        1987       4400                24000                                                                                                                                                    
Michael         1996      13000                24000                                                                                                                                                    
Pat             1997       6000                24000                                                                                                                                                    
Shelley         1994      12000                24000                                                                                                                                                    
William         1994       8300                24000                                                                                                                                                    
Steven          1987      24000                 6000                                                                                                                                                    

FIRST_NAME      TO_C     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Neena           1989      17000                 6000                                                                                                                                                    
Lex             1993      17000                 6000                                                                                                                                                    
Alexander       1990       9000                 6000                                                                                                                                                    
Bruce           1991       6000                 6000                                                                                                                                                    
Diana           1999       4200                 6000                                                                                                                                                    
Kevin           1999       5800                 6000                                                                                                                                                    
Trenna          1995       3500                 6000                                                                                                                                                    
Curtis          1997       3100                 6000                                                                                                                                                    
Randall         1998       2600                 6000                                                                                                                                                    
Peter           1998       2500                 6000                                                                                                                                                    
Eleni           2000      10500                 6000                                                                                                                                                    
Ellen           1996      11000                 6000                                                                                                                                                    
Jonathon        1998       8600                 6000                                                                                                                                                    
Kimerely        1999       7000                 6000                                                                                                                                                    
Jennifer        1987       4400                 6000                                                                                                                                                    
Michael         1996      13000                 6000                                                                                                                                                    
Pat             1997       6000                 6000                                                                                                                                                    
Shelley         1994      12000                 6000                                                                                                                                                    
William         1994       8300                 6000                                                                                                                                                    
Steven          1987      24000                10500                                                                                                                                                    
Neena           1989      17000                10500                                                                                                                                                    

FIRST_NAME      TO_C     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Lex             1993      17000                10500                                                                                                                                                    
Alexander       1990       9000                10500                                                                                                                                                    
Bruce           1991       6000                10500                                                                                                                                                    
Diana           1999       4200                10500                                                                                                                                                    
Kevin           1999       5800                10500                                                                                                                                                    
Trenna          1995       3500                10500                                                                                                                                                    
Curtis          1997       3100                10500                                                                                                                                                    
Randall         1998       2600                10500                                                                                                                                                    
Peter           1998       2500                10500                                                                                                                                                    
Eleni           2000      10500                10500                                                                                                                                                    
Ellen           1996      11000                10500                                                                                                                                                    
Jonathon        1998       8600                10500                                                                                                                                                    
Kimerely        1999       7000                10500                                                                                                                                                    
Jennifer        1987       4400                10500                                                                                                                                                    
Michael         1996      13000                10500                                                                                                                                                    
Pat             1997       6000                10500                                                                                                                                                    
Shelley         1994      12000                10500                                                                                                                                                    
William         1994       8300                10500                                                                                                                                                    
Steven          1987      24000                12000                                                                                                                                                    
Neena           1989      17000                12000                                                                                                                                                    
Lex             1993      17000                12000                                                                                                                                                    

FIRST_NAME      TO_C     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Alexander       1990       9000                12000                                                                                                                                                    
Bruce           1991       6000                12000                                                                                                                                                    
Diana           1999       4200                12000                                                                                                                                                    
Kevin           1999       5800                12000                                                                                                                                                    
Trenna          1995       3500                12000                                                                                                                                                    
Curtis          1997       3100                12000                                                                                                                                                    
Randall         1998       2600                12000                                                                                                                                                    
Peter           1998       2500                12000                                                                                                                                                    
Eleni           2000      10500                12000                                                                                                                                                    
Ellen           1996      11000                12000                                                                                                                                                    
Jonathon        1998       8600                12000                                                                                                                                                    
Kimerely        1999       7000                12000                                                                                                                                                    
Jennifer        1987       4400                12000                                                                                                                                                    
Michael         1996      13000                12000                                                                                                                                                    
Pat             1997       6000                12000                                                                                                                                                    
Shelley         1994      12000                12000                                                                                                                                                    
William         1994       8300                12000                                                                                                                                                    
Steven          1987      24000                 6000                                                                                                                                                    
Neena           1989      17000                 6000                                                                                                                                                    
Lex             1993      17000                 6000                                                                                                                                                    
Alexander       1990       9000                 6000                                                                                                                                                    

FIRST_NAME      TO_C     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Bruce           1991       6000                 6000                                                                                                                                                    
Diana           1999       4200                 6000                                                                                                                                                    
Kevin           1999       5800                 6000                                                                                                                                                    
Trenna          1995       3500                 6000                                                                                                                                                    
Curtis          1997       3100                 6000                                                                                                                                                    
Randall         1998       2600                 6000                                                                                                                                                    
Peter           1998       2500                 6000                                                                                                                                                    
Eleni           2000      10500                 6000                                                                                                                                                    
Ellen           1996      11000                 6000                                                                                                                                                    
Jonathon        1998       8600                 6000                                                                                                                                                    
Kimerely        1999       7000                 6000                                                                                                                                                    
Jennifer        1987       4400                 6000                                                                                                                                                    
Michael         1996      13000                 6000                                                                                                                                                    
Pat             1997       6000                 6000                                                                                                                                                    
Shelley         1994      12000                 6000                                                                                                                                                    
William         1994       8300                 6000                                                                                                                                                    
Steven          1987      24000                 3500                                                                                                                                                    
Neena           1989      17000                 3500                                                                                                                                                    
Lex             1993      17000                 3500                                                                                                                                                    
Alexander       1990       9000                 3500                                                                                                                                                    
Bruce           1991       6000                 3500                                                                                                                                                    

FIRST_NAME      TO_C     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Diana           1999       4200                 3500                                                                                                                                                    
Kevin           1999       5800                 3500                                                                                                                                                    
Trenna          1995       3500                 3500                                                                                                                                                    
Curtis          1997       3100                 3500                                                                                                                                                    
Randall         1998       2600                 3500                                                                                                                                                    
Peter           1998       2500                 3500                                                                                                                                                    
Eleni           2000      10500                 3500                                                                                                                                                    
Ellen           1996      11000                 3500                                                                                                                                                    
Jonathon        1998       8600                 3500                                                                                                                                                    
Kimerely        1999       7000                 3500                                                                                                                                                    
Jennifer        1987       4400                 3500                                                                                                                                                    
Michael         1996      13000                 3500                                                                                                                                                    
Pat             1997       6000                 3500                                                                                                                                                    
Shelley         1994      12000                 3500                                                                                                                                                    
William         1994       8300                 3500                                                                                                                                                    
Steven          1987      24000                 9000                                                                                                                                                    
Neena           1989      17000                 9000                                                                                                                                                    
Lex             1993      17000                 9000                                                                                                                                                    
Alexander       1990       9000                 9000                                                                                                                                                    
Bruce           1991       6000                 9000                                                                                                                                                    
Diana           1999       4200                 9000                                                                                                                                                    

FIRST_NAME      TO_C     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Kevin           1999       5800                 9000                                                                                                                                                    
Trenna          1995       3500                 9000                                                                                                                                                    
Curtis          1997       3100                 9000                                                                                                                                                    
Randall         1998       2600                 9000                                                                                                                                                    
Peter           1998       2500                 9000                                                                                                                                                    
Eleni           2000      10500                 9000                                                                                                                                                    
Ellen           1996      11000                 9000                                                                                                                                                    
Jonathon        1998       8600                 9000                                                                                                                                                    
Kimerely        1999       7000                 9000                                                                                                                                                    
Jennifer        1987       4400                 9000                                                                                                                                                    
Michael         1996      13000                 9000                                                                                                                                                    
Pat             1997       6000                 9000                                                                                                                                                    
Shelley         1994      12000                 9000                                                                                                                                                    
William         1994       8300                 9000                                                                                                                                                    
Steven          1987      24000                17000                                                                                                                                                    
Neena           1989      17000                17000                                                                                                                                                    
Lex             1993      17000                17000                                                                                                                                                    
Alexander       1990       9000                17000                                                                                                                                                    
Bruce           1991       6000                17000                                                                                                                                                    
Diana           1999       4200                17000                                                                                                                                                    
Kevin           1999       5800                17000                                                                                                                                                    

FIRST_NAME      TO_C     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Trenna          1995       3500                17000                                                                                                                                                    
Curtis          1997       3100                17000                                                                                                                                                    
Randall         1998       2600                17000                                                                                                                                                    
Peter           1998       2500                17000                                                                                                                                                    
Eleni           2000      10500                17000                                                                                                                                                    
Ellen           1996      11000                17000                                                                                                                                                    
Jonathon        1998       8600                17000                                                                                                                                                    
Kimerely        1999       7000                17000                                                                                                                                                    
Jennifer        1987       4400                17000                                                                                                                                                    
Michael         1996      13000                17000                                                                                                                                                    
Pat             1997       6000                17000                                                                                                                                                    
Shelley         1994      12000                17000                                                                                                                                                    
William         1994       8300                17000                                                                                                                                                    
Steven          1987      24000                17000                                                                                                                                                    
Neena           1989      17000                17000                                                                                                                                                    
Lex             1993      17000                17000                                                                                                                                                    
Alexander       1990       9000                17000                                                                                                                                                    
Bruce           1991       6000                17000                                                                                                                                                    
Diana           1999       4200                17000                                                                                                                                                    
Kevin           1999       5800                17000                                                                                                                                                    
Trenna          1995       3500                17000                                                                                                                                                    

FIRST_NAME      TO_C     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Curtis          1997       3100                17000                                                                                                                                                    
Randall         1998       2600                17000                                                                                                                                                    
Peter           1998       2500                17000                                                                                                                                                    
Eleni           2000      10500                17000                                                                                                                                                    
Ellen           1996      11000                17000                                                                                                                                                    
Jonathon        1998       8600                17000                                                                                                                                                    
Kimerely        1999       7000                17000                                                                                                                                                    
Jennifer        1987       4400                17000                                                                                                                                                    
Michael         1996      13000                17000                                                                                                                                                    
Pat             1997       6000                17000                                                                                                                                                    
Shelley         1994      12000                17000                                                                                                                                                    
William         1994       8300                17000                                                                                                                                                    
Steven          1987      24000                 7000                                                                                                                                                    
Neena           1989      17000                 7000                                                                                                                                                    
Lex             1993      17000                 7000                                                                                                                                                    
Alexander       1990       9000                 7000                                                                                                                                                    
Bruce           1991       6000                 7000                                                                                                                                                    
Diana           1999       4200                 7000                                                                                                                                                    
Kevin           1999       5800                 7000                                                                                                                                                    
Trenna          1995       3500                 7000                                                                                                                                                    
Curtis          1997       3100                 7000                                                                                                                                                    

FIRST_NAME      TO_C     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Randall         1998       2600                 7000                                                                                                                                                    
Peter           1998       2500                 7000                                                                                                                                                    
Eleni           2000      10500                 7000                                                                                                                                                    
Ellen           1996      11000                 7000                                                                                                                                                    
Jonathon        1998       8600                 7000                                                                                                                                                    
Kimerely        1999       7000                 7000                                                                                                                                                    
Jennifer        1987       4400                 7000                                                                                                                                                    
Michael         1996      13000                 7000                                                                                                                                                    
Pat             1997       6000                 7000                                                                                                                                                    
Shelley         1994      12000                 7000                                                                                                                                                    
William         1994       8300                 7000                                                                                                                                                    
Steven          1987      24000                13000                                                                                                                                                    
Neena           1989      17000                13000                                                                                                                                                    
Lex             1993      17000                13000                                                                                                                                                    
Alexander       1990       9000                13000                                                                                                                                                    
Bruce           1991       6000                13000                                                                                                                                                    
Diana           1999       4200                13000                                                                                                                                                    
Kevin           1999       5800                13000                                                                                                                                                    
Trenna          1995       3500                13000                                                                                                                                                    
Curtis          1997       3100                13000                                                                                                                                                    
Randall         1998       2600                13000                                                                                                                                                    

FIRST_NAME      TO_C     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Peter           1998       2500                13000                                                                                                                                                    
Eleni           2000      10500                13000                                                                                                                                                    
Ellen           1996      11000                13000                                                                                                                                                    
Jonathon        1998       8600                13000                                                                                                                                                    
Kimerely        1999       7000                13000                                                                                                                                                    
Jennifer        1987       4400                13000                                                                                                                                                    
Michael         1996      13000                13000                                                                                                                                                    
Pat             1997       6000                13000                                                                                                                                                    
Shelley         1994      12000                13000                                                                                                                                                    
William         1994       8300                13000                                                                                                                                                    
Steven          1987      24000                 8600                                                                                                                                                    
Neena           1989      17000                 8600                                                                                                                                                    
Lex             1993      17000                 8600                                                                                                                                                    
Alexander       1990       9000                 8600                                                                                                                                                    
Bruce           1991       6000                 8600                                                                                                                                                    
Diana           1999       4200                 8600                                                                                                                                                    
Kevin           1999       5800                 8600                                                                                                                                                    
Trenna          1995       3500                 8600                                                                                                                                                    
Curtis          1997       3100                 8600                                                                                                                                                    
Randall         1998       2600                 8600                                                                                                                                                    
Peter           1998       2500                 8600                                                                                                                                                    

FIRST_NAME      TO_C     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Eleni           2000      10500                 8600                                                                                                                                                    
Ellen           1996      11000                 8600                                                                                                                                                    
Jonathon        1998       8600                 8600                                                                                                                                                    
Kimerely        1999       7000                 8600                                                                                                                                                    
Jennifer        1987       4400                 8600                                                                                                                                                    
Michael         1996      13000                 8600                                                                                                                                                    
Pat             1997       6000                 8600                                                                                                                                                    
Shelley         1994      12000                 8600                                                                                                                                                    
William         1994       8300                 8600                                                                                                                                                    

240 rows selected.

SQL> SELECT FIRST_NAME , TO_CHAR(HIRE_DATE,'RRRR') HIREYEAR, SALARY , HIRE_YEAR_MAX_SALARY
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT TO_CHAR(HIRE_DATE,'RRRR') HIREYEAR , MAX(SALARY) HIRE_YEAR_MAX_SALARY FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'RRRR'));

FIRST_NAME      HIRE     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Steven          1987      24000                24000                                                                                                                                                    
Neena           1989      17000                24000                                                                                                                                                    
Lex             1993      17000                24000                                                                                                                                                    
Alexander       1990       9000                24000                                                                                                                                                    
Bruce           1991       6000                24000                                                                                                                                                    
Diana           1999       4200                24000                                                                                                                                                    
Kevin           1999       5800                24000                                                                                                                                                    
Trenna          1995       3500                24000                                                                                                                                                    
Curtis          1997       3100                24000                                                                                                                                                    
Randall         1998       2600                24000                                                                                                                                                    
Peter           1998       2500                24000                                                                                                                                                    
Eleni           2000      10500                24000                                                                                                                                                    
Ellen           1996      11000                24000                                                                                                                                                    
Jonathon        1998       8600                24000                                                                                                                                                    
Kimerely        1999       7000                24000                                                                                                                                                    
Jennifer        1987       4400                24000                                                                                                                                                    
Michael         1996      13000                24000                                                                                                                                                    
Pat             1997       6000                24000                                                                                                                                                    
Shelley         1994      12000                24000                                                                                                                                                    
William         1994       8300                24000                                                                                                                                                    
Steven          1987      24000                 6000                                                                                                                                                    

FIRST_NAME      HIRE     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Neena           1989      17000                 6000                                                                                                                                                    
Lex             1993      17000                 6000                                                                                                                                                    
Alexander       1990       9000                 6000                                                                                                                                                    
Bruce           1991       6000                 6000                                                                                                                                                    
Diana           1999       4200                 6000                                                                                                                                                    
Kevin           1999       5800                 6000                                                                                                                                                    
Trenna          1995       3500                 6000                                                                                                                                                    
Curtis          1997       3100                 6000                                                                                                                                                    
Randall         1998       2600                 6000                                                                                                                                                    
Peter           1998       2500                 6000                                                                                                                                                    
Eleni           2000      10500                 6000                                                                                                                                                    
Ellen           1996      11000                 6000                                                                                                                                                    
Jonathon        1998       8600                 6000                                                                                                                                                    
Kimerely        1999       7000                 6000                                                                                                                                                    
Jennifer        1987       4400                 6000                                                                                                                                                    
Michael         1996      13000                 6000                                                                                                                                                    
Pat             1997       6000                 6000                                                                                                                                                    
Shelley         1994      12000                 6000                                                                                                                                                    
William         1994       8300                 6000                                                                                                                                                    
Steven          1987      24000                10500                                                                                                                                                    
Neena           1989      17000                10500                                                                                                                                                    

FIRST_NAME      HIRE     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Lex             1993      17000                10500                                                                                                                                                    
Alexander       1990       9000                10500                                                                                                                                                    
Bruce           1991       6000                10500                                                                                                                                                    
Diana           1999       4200                10500                                                                                                                                                    
Kevin           1999       5800                10500                                                                                                                                                    
Trenna          1995       3500                10500                                                                                                                                                    
Curtis          1997       3100                10500                                                                                                                                                    
Randall         1998       2600                10500                                                                                                                                                    
Peter           1998       2500                10500                                                                                                                                                    
Eleni           2000      10500                10500                                                                                                                                                    
Ellen           1996      11000                10500                                                                                                                                                    
Jonathon        1998       8600                10500                                                                                                                                                    
Kimerely        1999       7000                10500                                                                                                                                                    
Jennifer        1987       4400                10500                                                                                                                                                    
Michael         1996      13000                10500                                                                                                                                                    
Pat             1997       6000                10500                                                                                                                                                    
Shelley         1994      12000                10500                                                                                                                                                    
William         1994       8300                10500                                                                                                                                                    
Steven          1987      24000                12000                                                                                                                                                    
Neena           1989      17000                12000                                                                                                                                                    
Lex             1993      17000                12000                                                                                                                                                    

FIRST_NAME      HIRE     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Alexander       1990       9000                12000                                                                                                                                                    
Bruce           1991       6000                12000                                                                                                                                                    
Diana           1999       4200                12000                                                                                                                                                    
Kevin           1999       5800                12000                                                                                                                                                    
Trenna          1995       3500                12000                                                                                                                                                    
Curtis          1997       3100                12000                                                                                                                                                    
Randall         1998       2600                12000                                                                                                                                                    
Peter           1998       2500                12000                                                                                                                                                    
Eleni           2000      10500                12000                                                                                                                                                    
Ellen           1996      11000                12000                                                                                                                                                    
Jonathon        1998       8600                12000                                                                                                                                                    
Kimerely        1999       7000                12000                                                                                                                                                    
Jennifer        1987       4400                12000                                                                                                                                                    
Michael         1996      13000                12000                                                                                                                                                    
Pat             1997       6000                12000                                                                                                                                                    
Shelley         1994      12000                12000                                                                                                                                                    
William         1994       8300                12000                                                                                                                                                    
Steven          1987      24000                 6000                                                                                                                                                    
Neena           1989      17000                 6000                                                                                                                                                    
Lex             1993      17000                 6000                                                                                                                                                    
Alexander       1990       9000                 6000                                                                                                                                                    

FIRST_NAME      HIRE     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Bruce           1991       6000                 6000                                                                                                                                                    
Diana           1999       4200                 6000                                                                                                                                                    
Kevin           1999       5800                 6000                                                                                                                                                    
Trenna          1995       3500                 6000                                                                                                                                                    
Curtis          1997       3100                 6000                                                                                                                                                    
Randall         1998       2600                 6000                                                                                                                                                    
Peter           1998       2500                 6000                                                                                                                                                    
Eleni           2000      10500                 6000                                                                                                                                                    
Ellen           1996      11000                 6000                                                                                                                                                    
Jonathon        1998       8600                 6000                                                                                                                                                    
Kimerely        1999       7000                 6000                                                                                                                                                    
Jennifer        1987       4400                 6000                                                                                                                                                    
Michael         1996      13000                 6000                                                                                                                                                    
Pat             1997       6000                 6000                                                                                                                                                    
Shelley         1994      12000                 6000                                                                                                                                                    
William         1994       8300                 6000                                                                                                                                                    
Steven          1987      24000                 3500                                                                                                                                                    
Neena           1989      17000                 3500                                                                                                                                                    
Lex             1993      17000                 3500                                                                                                                                                    
Alexander       1990       9000                 3500                                                                                                                                                    
Bruce           1991       6000                 3500                                                                                                                                                    

FIRST_NAME      HIRE     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Diana           1999       4200                 3500                                                                                                                                                    
Kevin           1999       5800                 3500                                                                                                                                                    
Trenna          1995       3500                 3500                                                                                                                                                    
Curtis          1997       3100                 3500                                                                                                                                                    
Randall         1998       2600                 3500                                                                                                                                                    
Peter           1998       2500                 3500                                                                                                                                                    
Eleni           2000      10500                 3500                                                                                                                                                    
Ellen           1996      11000                 3500                                                                                                                                                    
Jonathon        1998       8600                 3500                                                                                                                                                    
Kimerely        1999       7000                 3500                                                                                                                                                    
Jennifer        1987       4400                 3500                                                                                                                                                    
Michael         1996      13000                 3500                                                                                                                                                    
Pat             1997       6000                 3500                                                                                                                                                    
Shelley         1994      12000                 3500                                                                                                                                                    
William         1994       8300                 3500                                                                                                                                                    
Steven          1987      24000                 9000                                                                                                                                                    
Neena           1989      17000                 9000                                                                                                                                                    
Lex             1993      17000                 9000                                                                                                                                                    
Alexander       1990       9000                 9000                                                                                                                                                    
Bruce           1991       6000                 9000                                                                                                                                                    
Diana           1999       4200                 9000                                                                                                                                                    

FIRST_NAME      HIRE     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Kevin           1999       5800                 9000                                                                                                                                                    
Trenna          1995       3500                 9000                                                                                                                                                    
Curtis          1997       3100                 9000                                                                                                                                                    
Randall         1998       2600                 9000                                                                                                                                                    
Peter           1998       2500                 9000                                                                                                                                                    
Eleni           2000      10500                 9000                                                                                                                                                    
Ellen           1996      11000                 9000                                                                                                                                                    
Jonathon        1998       8600                 9000                                                                                                                                                    
Kimerely        1999       7000                 9000                                                                                                                                                    
Jennifer        1987       4400                 9000                                                                                                                                                    
Michael         1996      13000                 9000                                                                                                                                                    
Pat             1997       6000                 9000                                                                                                                                                    
Shelley         1994      12000                 9000                                                                                                                                                    
William         1994       8300                 9000                                                                                                                                                    
Steven          1987      24000                17000                                                                                                                                                    
Neena           1989      17000                17000                                                                                                                                                    
Lex             1993      17000                17000                                                                                                                                                    
Alexander       1990       9000                17000                                                                                                                                                    
Bruce           1991       6000                17000                                                                                                                                                    
Diana           1999       4200                17000                                                                                                                                                    
Kevin           1999       5800                17000                                                                                                                                                    

FIRST_NAME      HIRE     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Trenna          1995       3500                17000                                                                                                                                                    
Curtis          1997       3100                17000                                                                                                                                                    
Randall         1998       2600                17000                                                                                                                                                    
Peter           1998       2500                17000                                                                                                                                                    
Eleni           2000      10500                17000                                                                                                                                                    
Ellen           1996      11000                17000                                                                                                                                                    
Jonathon        1998       8600                17000                                                                                                                                                    
Kimerely        1999       7000                17000                                                                                                                                                    
Jennifer        1987       4400                17000                                                                                                                                                    
Michael         1996      13000                17000                                                                                                                                                    
Pat             1997       6000                17000                                                                                                                                                    
Shelley         1994      12000                17000                                                                                                                                                    
William         1994       8300                17000                                                                                                                                                    
Steven          1987      24000                17000                                                                                                                                                    
Neena           1989      17000                17000                                                                                                                                                    
Lex             1993      17000                17000                                                                                                                                                    
Alexander       1990       9000                17000                                                                                                                                                    
Bruce           1991       6000                17000                                                                                                                                                    
Diana           1999       4200                17000                                                                                                                                                    
Kevin           1999       5800                17000                                                                                                                                                    
Trenna          1995       3500                17000                                                                                                                                                    

FIRST_NAME      HIRE     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Curtis          1997       3100                17000                                                                                                                                                    
Randall         1998       2600                17000                                                                                                                                                    
Peter           1998       2500                17000                                                                                                                                                    
Eleni           2000      10500                17000                                                                                                                                                    
Ellen           1996      11000                17000                                                                                                                                                    
Jonathon        1998       8600                17000                                                                                                                                                    
Kimerely        1999       7000                17000                                                                                                                                                    
Jennifer        1987       4400                17000                                                                                                                                                    
Michael         1996      13000                17000                                                                                                                                                    
Pat             1997       6000                17000                                                                                                                                                    
Shelley         1994      12000                17000                                                                                                                                                    
William         1994       8300                17000                                                                                                                                                    
Steven          1987      24000                 7000                                                                                                                                                    
Neena           1989      17000                 7000                                                                                                                                                    
Lex             1993      17000                 7000                                                                                                                                                    
Alexander       1990       9000                 7000                                                                                                                                                    
Bruce           1991       6000                 7000                                                                                                                                                    
Diana           1999       4200                 7000                                                                                                                                                    
Kevin           1999       5800                 7000                                                                                                                                                    
Trenna          1995       3500                 7000                                                                                                                                                    
Curtis          1997       3100                 7000                                                                                                                                                    

FIRST_NAME      HIRE     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Randall         1998       2600                 7000                                                                                                                                                    
Peter           1998       2500                 7000                                                                                                                                                    
Eleni           2000      10500                 7000                                                                                                                                                    
Ellen           1996      11000                 7000                                                                                                                                                    
Jonathon        1998       8600                 7000                                                                                                                                                    
Kimerely        1999       7000                 7000                                                                                                                                                    
Jennifer        1987       4400                 7000                                                                                                                                                    
Michael         1996      13000                 7000                                                                                                                                                    
Pat             1997       6000                 7000                                                                                                                                                    
Shelley         1994      12000                 7000                                                                                                                                                    
William         1994       8300                 7000                                                                                                                                                    
Steven          1987      24000                13000                                                                                                                                                    
Neena           1989      17000                13000                                                                                                                                                    
Lex             1993      17000                13000                                                                                                                                                    
Alexander       1990       9000                13000                                                                                                                                                    
Bruce           1991       6000                13000                                                                                                                                                    
Diana           1999       4200                13000                                                                                                                                                    
Kevin           1999       5800                13000                                                                                                                                                    
Trenna          1995       3500                13000                                                                                                                                                    
Curtis          1997       3100                13000                                                                                                                                                    
Randall         1998       2600                13000                                                                                                                                                    

FIRST_NAME      HIRE     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Peter           1998       2500                13000                                                                                                                                                    
Eleni           2000      10500                13000                                                                                                                                                    
Ellen           1996      11000                13000                                                                                                                                                    
Jonathon        1998       8600                13000                                                                                                                                                    
Kimerely        1999       7000                13000                                                                                                                                                    
Jennifer        1987       4400                13000                                                                                                                                                    
Michael         1996      13000                13000                                                                                                                                                    
Pat             1997       6000                13000                                                                                                                                                    
Shelley         1994      12000                13000                                                                                                                                                    
William         1994       8300                13000                                                                                                                                                    
Steven          1987      24000                 8600                                                                                                                                                    
Neena           1989      17000                 8600                                                                                                                                                    
Lex             1993      17000                 8600                                                                                                                                                    
Alexander       1990       9000                 8600                                                                                                                                                    
Bruce           1991       6000                 8600                                                                                                                                                    
Diana           1999       4200                 8600                                                                                                                                                    
Kevin           1999       5800                 8600                                                                                                                                                    
Trenna          1995       3500                 8600                                                                                                                                                    
Curtis          1997       3100                 8600                                                                                                                                                    
Randall         1998       2600                 8600                                                                                                                                                    
Peter           1998       2500                 8600                                                                                                                                                    

FIRST_NAME      HIRE     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Eleni           2000      10500                 8600                                                                                                                                                    
Ellen           1996      11000                 8600                                                                                                                                                    
Jonathon        1998       8600                 8600                                                                                                                                                    
Kimerely        1999       7000                 8600                                                                                                                                                    
Jennifer        1987       4400                 8600                                                                                                                                                    
Michael         1996      13000                 8600                                                                                                                                                    
Pat             1997       6000                 8600                                                                                                                                                    
Shelley         1994      12000                 8600                                                                                                                                                    
William         1994       8300                 8600                                                                                                                                                    

240 rows selected.

SQL> SELECT FIRST_NAME , TO_CHAR(HIRE_DATE,'RRRR') HIREYEAR, SALARY , HIRE_YEAR_MAX_SALARY
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT TO_CHAR(HIRE_DATE,'RRRR') HIREYEAR , MAX(SALARY) HIRE_YEAR_MAX_SALARY FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'RRRR'))
  4  
SQL> 
SQL> SELECT FIRST_NAME , HIREYEAR , SALARY , HIRE_YEAR_MAX_SALARY FROM (SELECT FIRST_NAME , TO_CHAR(HIRE_DATE,'RRRR') HIREYEAR, SALARY FROM EMPLOYEES)
  2  NATURAL JOIN (SELECT TO_CHAR(HIRE_DATE,'RRRR') HIREYEAR , MAX(SALARY) HIRE_YEAR_MAX_SALARY FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'RRRR'));

FIRST_NAME      HIRE     SALARY HIRE_YEAR_MAX_SALARY                                                                                                                                                    
--------------- ---- ---------- --------------------                                                                                                                                                    
Steven          1987      24000                24000                                                                                                                                                    
Jennifer        1987       4400                24000                                                                                                                                                    
Diana           1999       4200                 7000                                                                                                                                                    
Kimerely        1999       7000                 7000                                                                                                                                                    
Neena           1989      17000                17000                                                                                                                                                    
Eleni           2000      10500                10500                                                                                                                                                    
Ellen           1996      11000                13000                                                                                                                                                    
Shelley         1994      12000                12000                                                                                                                                                    
Lex             1993      17000                17000                                                                                                                                                    
Peter           1998       2500                 8600                                                                                                                                                    
Bruce           1991       6000                 6000                                                                                                                                                    
Kevin           1999       5800                 7000                                                                                                                                                    
Trenna          1995       3500                 3500                                                                                                                                                    
Curtis          1997       3100                 6000                                                                                                                                                    
Randall         1998       2600                 8600                                                                                                                                                    
Michael         1996      13000                13000                                                                                                                                                    
Alexander       1990       9000                 9000                                                                                                                                                    
Jonathon        1998       8600                 8600                                                                                                                                                    
William         1994       8300                12000                                                                                                                                                    
Pat             1997       6000                 6000                                                                                                                                                    

20 rows selected.

SQL> SPOOL OFF
