SQL> 
SQL> REM DISPLAY THOSE WHO GETS SALARY HIGHER THAN Abel.
SQL> 
SQL> SELECT * FROM EMPLOYEES;

EMPLOYEE_ID FIRST_NAME      LAST_NAME       EMAIL      PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                                     
----------- --------------- --------------- ---------- -------------------- --------- ---------- ---------- -------------- ---------- -------------                                                     
        100 Steven          King            SKING      515.123.4567         17-JUL-87 AD_PRES         24000                                      90                                                     
        101 Neena           Kochhar         NKOCHHAR   515.123.4568         21-SEP-89 AD_VP           17000                       100            90                                                     
        102 Lex             De Haan         LDEHAAN    515.123.4569         13-JAN-93 AD_VP           17000                       100            90                                                     
        103 Alexander       Hunold          AHUNOLD    590.423.4567         03-JAN-90 IT_PROG          9000                       102            60                                                     
        104 Bruce           Ernst           BERNST     590.423.4568         21-MAY-91 IT_PROG          6000                       103            60                                                     
        107 Diana           Lorentz         DLORENTZ   590.423.5567         07-FEB-99 IT_PROG          4200                       103            60                                                     
        124 Kevin           Mourgos         KMOURGOS   650.123.5234         16-NOV-99 ST_MAN           5800                       100            50                                                     
        141 Trenna          Rajs            TRAJS      650.121.8009         17-OCT-95 ST_CLERK         3500                       124            50                                                     
        142 Curtis          Davies          CDAVIES    650.121.2994         29-JAN-97 ST_CLERK         3100                       124            50                                                     
        143 Randall         Matos           RMATOS     650.121.2874         15-MAR-98 ST_CLERK         2600                       124            50                                                     
        144 Peter           Vargas                     650.121.2004         09-JUL-98 ST_CLERK         2500                       124            50                                                     
        149 Eleni           Zlotkey         EZLOTKEY   011.44.1344.429018   29-JAN-00 SA_MAN          10500             ~2        100            80                                                     
        174 Ellen           Abel            EABEL      011.44.1644.429267   11-MAY-96 SA_REP          11000             ~3        149            80                                                     
        176 Jonathon        Taylor          JTAYLOR    011.44.1644.429265   24-MAR-98 SA_REP           8600             ~3        149            80                                                     
        178 Kimerely        Grant           KGRANT     011.44.1644.429263   24-MAY-99 SA_REP           7000            ~15        149                                                                   
        200 Jennifer        Whalen          JWHALEN    515.123.4444         17-SEP-87 AD_ASST          4400                       101            10                                                     
        201 Michael         Hartstein       MHARTSTE   515.123.5555         17-FEB-96 MK_MAN          13000                       100            20                                                     
        202 Pat             Fay             PFAY       603.123.6666         17-AUG-97 MK_REP           6000                       201            20                                                     
        205 Shelley         Higgins         SHIGGINS   515.123.8080         07-JUN-94 AC_MGR          12000                       101           110                                                     
        206 William         Gietz           WGIETZ     515.123.8181         07-JUN-94 AC_ACCOUNT       8300                       205           110                                                     

20 rows selected.

SQL> SELECT * FROM EMPLOYEES WHERE SALARY > 11000;

EMPLOYEE_ID FIRST_NAME      LAST_NAME       EMAIL      PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                                     
----------- --------------- --------------- ---------- -------------------- --------- ---------- ---------- -------------- ---------- -------------                                                     
        100 Steven          King            SKING      515.123.4567         17-JUL-87 AD_PRES         24000                                      90                                                     
        101 Neena           Kochhar         NKOCHHAR   515.123.4568         21-SEP-89 AD_VP           17000                       100            90                                                     
        102 Lex             De Haan         LDEHAAN    515.123.4569         13-JAN-93 AD_VP           17000                       100            90                                                     
        201 Michael         Hartstein       MHARTSTE   515.123.5555         17-FEB-96 MK_MAN          13000                       100            20                                                     
        205 Shelley         Higgins         SHIGGINS   515.123.8080         07-JUN-94 AC_MGR          12000                       101           110                                                     

SQL> REM ABOVE QUERY IS STATIC
SQL> 
SQL> REM TO MAKE IT DYNMIC , WE SHOULD GO FOR SUB QUERY IN PLACE OF LITERAL VALUE.
SQL> 
SQL> SELECT * FROM EMPLOYEES;

EMPLOYEE_ID FIRST_NAME      LAST_NAME       EMAIL      PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                                     
----------- --------------- --------------- ---------- -------------------- --------- ---------- ---------- -------------- ---------- -------------                                                     
        100 Steven          King            SKING      515.123.4567         17-JUL-87 AD_PRES         24000                                      90                                                     
        101 Neena           Kochhar         NKOCHHAR   515.123.4568         21-SEP-89 AD_VP           17000                       100            90                                                     
        102 Lex             De Haan         LDEHAAN    515.123.4569         13-JAN-93 AD_VP           17000                       100            90                                                     
        103 Alexander       Hunold          AHUNOLD    590.423.4567         03-JAN-90 IT_PROG          9000                       102            60                                                     
        104 Bruce           Ernst           BERNST     590.423.4568         21-MAY-91 IT_PROG          6000                       103            60                                                     
        107 Diana           Lorentz         DLORENTZ   590.423.5567         07-FEB-99 IT_PROG          4200                       103            60                                                     
        124 Kevin           Mourgos         KMOURGOS   650.123.5234         16-NOV-99 ST_MAN           5800                       100            50                                                     
        141 Trenna          Rajs            TRAJS      650.121.8009         17-OCT-95 ST_CLERK         3500                       124            50                                                     
        142 Curtis          Davies          CDAVIES    650.121.2994         29-JAN-97 ST_CLERK         3100                       124            50                                                     
        143 Randall         Matos           RMATOS     650.121.2874         15-MAR-98 ST_CLERK         2600                       124            50                                                     
        144 Peter           Vargas                     650.121.2004         09-JUL-98 ST_CLERK         2500                       124            50                                                     
        149 Eleni           Zlotkey         EZLOTKEY   011.44.1344.429018   29-JAN-00 SA_MAN          10500             ~2        100            80                                                     
        174 Ellen           Abel            EABEL      011.44.1644.429267   11-MAY-96 SA_REP          11000             ~3        149            80                                                     
        176 Jonathon        Taylor          JTAYLOR    011.44.1644.429265   24-MAR-98 SA_REP           8600             ~3        149            80                                                     
        178 Kimerely        Grant           KGRANT     011.44.1644.429263   24-MAY-99 SA_REP           7000            ~15        149                                                                   
        200 Jennifer        Whalen          JWHALEN    515.123.4444         17-SEP-87 AD_ASST          4400                       101            10                                                     
        201 Michael         Hartstein       MHARTSTE   515.123.5555         17-FEB-96 MK_MAN          13000                       100            20                                                     
        202 Pat             Fay             PFAY       603.123.6666         17-AUG-97 MK_REP           6000                       201            20                                                     
        205 Shelley         Higgins         SHIGGINS   515.123.8080         07-JUN-94 AC_MGR          12000                       101           110                                                     
        206 William         Gietz           WGIETZ     515.123.8181         07-JUN-94 AC_ACCOUNT       8300                       205           110                                                     

20 rows selected.

SQL> SELECT * FROM DEPARTMENTS;

DEPARTMENT_ID DEPARTMENT_NAME                MANAGER_ID LOCATION_ID                                                                                                                                     
------------- ------------------------------ ---------- -----------                                                                                                                                     
           10 Administration                        200        1700                                                                                                                                     
           20 Marketing                             201        1800                                                                                                                                     
           50 Shiping                               124        1500                                                                                                                                     
           60 IT                                    103        1400                                                                                                                                     
           80 Sales                                 149        2500                                                                                                                                     
           90 Executive                             100        1700                                                                                                                                     
          110 Accounting                            205        1700                                                                                                                                     
          190 Contracting                                      1700                                                                                                                                     

8 rows selected.

SQL> SELECT * FROM LOCATIONS;

LOCATION_ID STREET_ADRESS                            POSTAL_CODE  CITY                           STATE_PROVINCE            CO                                                                           
----------- ---------------------------------------- ------------ ------------------------------ ------------------------- --                                                                           
       1400 2014 Jabberwocky Rd                      26192        Southlake                      Texas                     US                                                                           
       1500 2011 Interiors Blvd                      99236        South San Francisco            California                US                                                                           
       1700 2004 Charade Rd                          98199        Seattle                        Washington                US                                                                           
       1800 460 Bloor St. W.                         ON M5S 1X8   Toronto                        Ontario                   CA                                                                           
       2500 Magdalen Centre, The Oxford Science Park OX9 9ZB      Oxford                         Oxford                    UK                                                                           

SQL> REM DISPLAY THOSE WHO WORKS IN Toronto
SQL> 
SQL> REM FIRST_NAME , HIRE_YEAR , SALARY , YEAR_MAX_SALARY
SQL> 
SQL> SELECT FIRST_NAME , TO_CHAR(HIRE_DATE,'RRRR') HIRE_YEAR , SALARY , YEAR_MAX_SALARY
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT TO_CHAR(HIRE_DATE,'RRRR') HIRE_YEAR , MAX(SALARY) YEAR_MAX_SALARY FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'RRRR'));

FIRST_NAME      HIRE     SALARY YEAR_MAX_SALARY                                                                                                                                                         
--------------- ---- ---------- ---------------                                                                                                                                                         
Steven          1987      24000           24000                                                                                                                                                         
Neena           1989      17000           24000                                                                                                                                                         
Lex             1993      17000           24000                                                                                                                                                         
Alexander       1990       9000           24000                                                                                                                                                         
Bruce           1991       6000           24000                                                                                                                                                         
Diana           1999       4200           24000                                                                                                                                                         
Kevin           1999       5800           24000                                                                                                                                                         
Trenna          1995       3500           24000                                                                                                                                                         
Curtis          1997       3100           24000                                                                                                                                                         
Randall         1998       2600           24000                                                                                                                                                         
Peter           1998       2500           24000                                                                                                                                                         
Eleni           2000      10500           24000                                                                                                                                                         
Ellen           1996      11000           24000                                                                                                                                                         
Jonathon        1998       8600           24000                                                                                                                                                         
Kimerely        1999       7000           24000                                                                                                                                                         
Jennifer        1987       4400           24000                                                                                                                                                         
Michael         1996      13000           24000                                                                                                                                                         
Pat             1997       6000           24000                                                                                                                                                         
Shelley         1994      12000           24000                                                                                                                                                         
William         1994       8300           24000                                                                                                                                                         
Steven          1987      24000            6000                                                                                                                                                         

FIRST_NAME      HIRE     SALARY YEAR_MAX_SALARY                                                                                                                                                         
--------------- ---- ---------- ---------------                                                                                                                                                         
Neena           1989      17000            6000                                                                                                                                                         
Lex             1993      17000            6000                                                                                                                                                         
Alexander       1990       9000            6000                                                                                                                                                         
Bruce           1991       6000            6000                                                                                                                                                         
Diana           1999       4200            6000                                                                                                                                                         
Kevin           1999       5800            6000                                                                                                                                                         
Trenna          1995       3500            6000                                                                                                                                                         
Curtis          1997       3100            6000                                                                                                                                                         
Randall         1998       2600            6000                                                                                                                                                         
Peter           1998       2500            6000                                                                                                                                                         
Eleni           2000      10500            6000                                                                                                                                                         
Ellen           1996      11000            6000                                                                                                                                                         
Jonathon        1998       8600            6000                                                                                                                                                         
Kimerely        1999       7000            6000                                                                                                                                                         
Jennifer        1987       4400            6000                                                                                                                                                         
Michael         1996      13000            6000                                                                                                                                                         
Pat             1997       6000            6000                                                                                                                                                         
Shelley         1994      12000            6000                                                                                                                                                         
William         1994       8300            6000                                                                                                                                                         
Steven          1987      24000           10500                                                                                                                                                         
Neena           1989      17000           10500                                                                                                                                                         

FIRST_NAME      HIRE     SALARY YEAR_MAX_SALARY                                                                                                                                                         
--------------- ---- ---------- ---------------                                                                                                                                                         
Lex             1993      17000           10500                                                                                                                                                         
Alexander       1990       9000           10500                                                                                                                                                         
Bruce           1991       6000           10500                                                                                                                                                         
Diana           1999       4200           10500                                                                                                                                                         
Kevin           1999       5800           10500                                                                                                                                                         
Trenna          1995       3500           10500                                                                                                                                                         
Curtis          1997       3100           10500                                                                                                                                                         
Randall         1998       2600           10500                                                                                                                                                         
Peter           1998       2500           10500                                                                                                                                                         
Eleni           2000      10500           10500                                                                                                                                                         
Ellen           1996      11000           10500                                                                                                                                                         
Jonathon        1998       8600           10500                                                                                                                                                         
Kimerely        1999       7000           10500                                                                                                                                                         
Jennifer        1987       4400           10500                                                                                                                                                         
Michael         1996      13000           10500                                                                                                                                                         
Pat             1997       6000           10500                                                                                                                                                         
Shelley         1994      12000           10500                                                                                                                                                         
William         1994       8300           10500                                                                                                                                                         
Steven          1987      24000           12000                                                                                                                                                         
Neena           1989      17000           12000                                                                                                                                                         
Lex             1993      17000           12000                                                                                                                                                         

FIRST_NAME      HIRE     SALARY YEAR_MAX_SALARY                                                                                                                                                         
--------------- ---- ---------- ---------------                                                                                                                                                         
Alexander       1990       9000           12000                                                                                                                                                         
Bruce           1991       6000           12000                                                                                                                                                         
Diana           1999       4200           12000                                                                                                                                                         
Kevin           1999       5800           12000                                                                                                                                                         
Trenna          1995       3500           12000                                                                                                                                                         
Curtis          1997       3100           12000                                                                                                                                                         
Randall         1998       2600           12000                                                                                                                                                         
Peter           1998       2500           12000                                                                                                                                                         
Eleni           2000      10500           12000                                                                                                                                                         
Ellen           1996      11000           12000                                                                                                                                                         
Jonathon        1998       8600           12000                                                                                                                                                         
Kimerely        1999       7000           12000                                                                                                                                                         
Jennifer        1987       4400           12000                                                                                                                                                         
Michael         1996      13000           12000                                                                                                                                                         
Pat             1997       6000           12000                                                                                                                                                         
Shelley         1994      12000           12000                                                                                                                                                         
William         1994       8300           12000                                                                                                                                                         
Steven          1987      24000            6000                                                                                                                                                         
Neena           1989      17000            6000                                                                                                                                                         
Lex             1993      17000            6000                                                                                                                                                         
Alexander       1990       9000            6000                                                                                                                                                         

FIRST_NAME      HIRE     SALARY YEAR_MAX_SALARY                                                                                                                                                         
--------------- ---- ---------- ---------------                                                                                                                                                         
Bruce           1991       6000            6000                                                                                                                                                         
Diana           1999       4200            6000                                                                                                                                                         
Kevin           1999       5800            6000                                                                                                                                                         
Trenna          1995       3500            6000                                                                                                                                                         
Curtis          1997       3100            6000                                                                                                                                                         
Randall         1998       2600            6000                                                                                                                                                         
Peter           1998       2500            6000                                                                                                                                                         
Eleni           2000      10500            6000                                                                                                                                                         
Ellen           1996      11000            6000                                                                                                                                                         
Jonathon        1998       8600            6000                                                                                                                                                         
Kimerely        1999       7000            6000                                                                                                                                                         
Jennifer        1987       4400            6000                                                                                                                                                         
Michael         1996      13000            6000                                                                                                                                                         
Pat             1997       6000            6000                                                                                                                                                         
Shelley         1994      12000            6000                                                                                                                                                         
William         1994       8300            6000                                                                                                                                                         
Steven          1987      24000            3500                                                                                                                                                         
Neena           1989      17000            3500                                                                                                                                                         
Lex             1993      17000            3500                                                                                                                                                         
Alexander       1990       9000            3500                                                                                                                                                         
Bruce           1991       6000            3500                                                                                                                                                         

FIRST_NAME      HIRE     SALARY YEAR_MAX_SALARY                                                                                                                                                         
--------------- ---- ---------- ---------------                                                                                                                                                         
Diana           1999       4200            3500                                                                                                                                                         
Kevin           1999       5800            3500                                                                                                                                                         
Trenna          1995       3500            3500                                                                                                                                                         
Curtis          1997       3100            3500                                                                                                                                                         
Randall         1998       2600            3500                                                                                                                                                         
Peter           1998       2500            3500                                                                                                                                                         
Eleni           2000      10500            3500                                                                                                                                                         
Ellen           1996      11000            3500                                                                                                                                                         
Jonathon        1998       8600            3500                                                                                                                                                         
Kimerely        1999       7000            3500                                                                                                                                                         
Jennifer        1987       4400            3500                                                                                                                                                         
Michael         1996      13000            3500                                                                                                                                                         
Pat             1997       6000            3500                                                                                                                                                         
Shelley         1994      12000            3500                                                                                                                                                         
William         1994       8300            3500                                                                                                                                                         
Steven          1987      24000            9000                                                                                                                                                         
Neena           1989      17000            9000                                                                                                                                                         
Lex             1993      17000            9000                                                                                                                                                         
Alexander       1990       9000            9000                                                                                                                                                         
Bruce           1991       6000            9000                                                                                                                                                         
Diana           1999       4200            9000                                                                                                                                                         

FIRST_NAME      HIRE     SALARY YEAR_MAX_SALARY                                                                                                                                                         
--------------- ---- ---------- ---------------                                                                                                                                                         
Kevin           1999       5800            9000                                                                                                                                                         
Trenna          1995       3500            9000                                                                                                                                                         
Curtis          1997       3100            9000                                                                                                                                                         
Randall         1998       2600            9000                                                                                                                                                         
Peter           1998       2500            9000                                                                                                                                                         
Eleni           2000      10500            9000                                                                                                                                                         
Ellen           1996      11000            9000                                                                                                                                                         
Jonathon        1998       8600            9000                                                                                                                                                         
Kimerely        1999       7000            9000                                                                                                                                                         
Jennifer        1987       4400            9000                                                                                                                                                         
Michael         1996      13000            9000                                                                                                                                                         
Pat             1997       6000            9000                                                                                                                                                         
Shelley         1994      12000            9000                                                                                                                                                         
William         1994       8300            9000                                                                                                                                                         
Steven          1987      24000           17000                                                                                                                                                         
Neena           1989      17000           17000                                                                                                                                                         
Lex             1993      17000           17000                                                                                                                                                         
Alexander       1990       9000           17000                                                                                                                                                         
Bruce           1991       6000           17000                                                                                                                                                         
Diana           1999       4200           17000                                                                                                                                                         
Kevin           1999       5800           17000                                                                                                                                                         

FIRST_NAME      HIRE     SALARY YEAR_MAX_SALARY                                                                                                                                                         
--------------- ---- ---------- ---------------                                                                                                                                                         
Trenna          1995       3500           17000                                                                                                                                                         
Curtis          1997       3100           17000                                                                                                                                                         
Randall         1998       2600           17000                                                                                                                                                         
Peter           1998       2500           17000                                                                                                                                                         
Eleni           2000      10500           17000                                                                                                                                                         
Ellen           1996      11000           17000                                                                                                                                                         
Jonathon        1998       8600           17000                                                                                                                                                         
Kimerely        1999       7000           17000                                                                                                                                                         
Jennifer        1987       4400           17000                                                                                                                                                         
Michael         1996      13000           17000                                                                                                                                                         
Pat             1997       6000           17000                                                                                                                                                         
Shelley         1994      12000           17000                                                                                                                                                         
William         1994       8300           17000                                                                                                                                                         
Steven          1987      24000           17000                                                                                                                                                         
Neena           1989      17000           17000                                                                                                                                                         
Lex             1993      17000           17000                                                                                                                                                         
Alexander       1990       9000           17000                                                                                                                                                         
Bruce           1991       6000           17000                                                                                                                                                         
Diana           1999       4200           17000                                                                                                                                                         
Kevin           1999       5800           17000                                                                                                                                                         
Trenna          1995       3500           17000                                                                                                                                                         

FIRST_NAME      HIRE     SALARY YEAR_MAX_SALARY                                                                                                                                                         
--------------- ---- ---------- ---------------                                                                                                                                                         
Curtis          1997       3100           17000                                                                                                                                                         
Randall         1998       2600           17000                                                                                                                                                         
Peter           1998       2500           17000                                                                                                                                                         
Eleni           2000      10500           17000                                                                                                                                                         
Ellen           1996      11000           17000                                                                                                                                                         
Jonathon        1998       8600           17000                                                                                                                                                         
Kimerely        1999       7000           17000                                                                                                                                                         
Jennifer        1987       4400           17000                                                                                                                                                         
Michael         1996      13000           17000                                                                                                                                                         
Pat             1997       6000           17000                                                                                                                                                         
Shelley         1994      12000           17000                                                                                                                                                         
William         1994       8300           17000                                                                                                                                                         
Steven          1987      24000            7000                                                                                                                                                         
Neena           1989      17000            7000                                                                                                                                                         
Lex             1993      17000            7000                                                                                                                                                         
Alexander       1990       9000            7000                                                                                                                                                         
Bruce           1991       6000            7000                                                                                                                                                         
Diana           1999       4200            7000                                                                                                                                                         
Kevin           1999       5800            7000                                                                                                                                                         
Trenna          1995       3500            7000                                                                                                                                                         
Curtis          1997       3100            7000                                                                                                                                                         

FIRST_NAME      HIRE     SALARY YEAR_MAX_SALARY                                                                                                                                                         
--------------- ---- ---------- ---------------                                                                                                                                                         
Randall         1998       2600            7000                                                                                                                                                         
Peter           1998       2500            7000                                                                                                                                                         
Eleni           2000      10500            7000                                                                                                                                                         
Ellen           1996      11000            7000                                                                                                                                                         
Jonathon        1998       8600            7000                                                                                                                                                         
Kimerely        1999       7000            7000                                                                                                                                                         
Jennifer        1987       4400            7000                                                                                                                                                         
Michael         1996      13000            7000                                                                                                                                                         
Pat             1997       6000            7000                                                                                                                                                         
Shelley         1994      12000            7000                                                                                                                                                         
William         1994       8300            7000                                                                                                                                                         
Steven          1987      24000           13000                                                                                                                                                         
Neena           1989      17000           13000                                                                                                                                                         
Lex             1993      17000           13000                                                                                                                                                         
Alexander       1990       9000           13000                                                                                                                                                         
Bruce           1991       6000           13000                                                                                                                                                         
Diana           1999       4200           13000                                                                                                                                                         
Kevin           1999       5800           13000                                                                                                                                                         
Trenna          1995       3500           13000                                                                                                                                                         
Curtis          1997       3100           13000                                                                                                                                                         
Randall         1998       2600           13000                                                                                                                                                         

FIRST_NAME      HIRE     SALARY YEAR_MAX_SALARY                                                                                                                                                         
--------------- ---- ---------- ---------------                                                                                                                                                         
Peter           1998       2500           13000                                                                                                                                                         
Eleni           2000      10500           13000                                                                                                                                                         
Ellen           1996      11000           13000                                                                                                                                                         
Jonathon        1998       8600           13000                                                                                                                                                         
Kimerely        1999       7000           13000                                                                                                                                                         
Jennifer        1987       4400           13000                                                                                                                                                         
Michael         1996      13000           13000                                                                                                                                                         
Pat             1997       6000           13000                                                                                                                                                         
Shelley         1994      12000           13000                                                                                                                                                         
William         1994       8300           13000                                                                                                                                                         
Steven          1987      24000            8600                                                                                                                                                         
Neena           1989      17000            8600                                                                                                                                                         
Lex             1993      17000            8600                                                                                                                                                         
Alexander       1990       9000            8600                                                                                                                                                         
Bruce           1991       6000            8600                                                                                                                                                         
Diana           1999       4200            8600                                                                                                                                                         
Kevin           1999       5800            8600                                                                                                                                                         
Trenna          1995       3500            8600                                                                                                                                                         
Curtis          1997       3100            8600                                                                                                                                                         
Randall         1998       2600            8600                                                                                                                                                         
Peter           1998       2500            8600                                                                                                                                                         

FIRST_NAME      HIRE     SALARY YEAR_MAX_SALARY                                                                                                                                                         
--------------- ---- ---------- ---------------                                                                                                                                                         
Eleni           2000      10500            8600                                                                                                                                                         
Ellen           1996      11000            8600                                                                                                                                                         
Jonathon        1998       8600            8600                                                                                                                                                         
Kimerely        1999       7000            8600                                                                                                                                                         
Jennifer        1987       4400            8600                                                                                                                                                         
Michael         1996      13000            8600                                                                                                                                                         
Pat             1997       6000            8600                                                                                                                                                         
Shelley         1994      12000            8600                                                                                                                                                         
William         1994       8300            8600                                                                                                                                                         

240 rows selected.

SQL> SELECT FIRST_NAME , TO_CHAR(HIRE_DATE,'RRRR') HIRE_YEAR , SALARY , YEAR_MAX_SALARY
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT TO_CHAR(HIRE_DATE,'RRRR') HIRE_YEAR , MAX(SALARY) YEAR_MAX_SALARY FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'RRRR'))
  4  
SQL> 
SQL> SELECT FIRST_NAME , HIRE_YEAR , SALARY , YEAR_MAX_SALARY
  2  FROM (SELECT FIRST_NAME , TO_CHAR(HIRE_DATE,'RRRR') HIRE_YEAR , SALARY FROM EMPLOYEES)
  3  NATURAL JOIN (SELECT TO_CHAR(HIRE_DATE,'RRRR') HIRE_YEAR , MAX(SALARY) YEAR_MAX_SALARY FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'RRRR'));

FIRST_NAME      HIRE     SALARY YEAR_MAX_SALARY                                                                                                                                                         
--------------- ---- ---------- ---------------                                                                                                                                                         
Steven          1987      24000           24000                                                                                                                                                         
Jennifer        1987       4400           24000                                                                                                                                                         
Diana           1999       4200            7000                                                                                                                                                         
Kimerely        1999       7000            7000                                                                                                                                                         
Neena           1989      17000           17000                                                                                                                                                         
Eleni           2000      10500           10500                                                                                                                                                         
Ellen           1996      11000           13000                                                                                                                                                         
Shelley         1994      12000           12000                                                                                                                                                         
Lex             1993      17000           17000                                                                                                                                                         
Peter           1998       2500            8600                                                                                                                                                         
Bruce           1991       6000            6000                                                                                                                                                         
Kevin           1999       5800            7000                                                                                                                                                         
Trenna          1995       3500            3500                                                                                                                                                         
Curtis          1997       3100            6000                                                                                                                                                         
Randall         1998       2600            8600                                                                                                                                                         
Michael         1996      13000           13000                                                                                                                                                         
Alexander       1990       9000            9000                                                                                                                                                         
Jonathon        1998       8600            8600                                                                                                                                                         
William         1994       8300           12000                                                                                                                                                         
Pat             1997       6000            6000                                                                                                                                                         

20 rows selected.

SQL> SELECT FIRST_NAME , HIRE_YEAR , SALARY , YEAR_MAX_SALARY
  2  FROM (SELECT FIRST_NAME , TO_CHAR(HIRE_DATE,'RRRR') HIRE_YEAR , SALARY FROM EMPLOYEES)
  3  NATURAL JOIN (SELECT TO_CHAR(HIRE_DATE,'RRRR') HIRE_YEAR , MAX(SALARY) YEAR_MAX_SALARY FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'RRRR'))
  4  ORDER BY 2;

FIRST_NAME      HIRE     SALARY YEAR_MAX_SALARY                                                                                                                                                         
--------------- ---- ---------- ---------------                                                                                                                                                         
Steven          1987      24000           24000                                                                                                                                                         
Jennifer        1987       4400           24000                                                                                                                                                         
Neena           1989      17000           17000                                                                                                                                                         
Alexander       1990       9000            9000                                                                                                                                                         
Bruce           1991       6000            6000                                                                                                                                                         
Lex             1993      17000           17000                                                                                                                                                         
Shelley         1994      12000           12000                                                                                                                                                         
William         1994       8300           12000                                                                                                                                                         
Trenna          1995       3500            3500                                                                                                                                                         
Ellen           1996      11000           13000                                                                                                                                                         
Michael         1996      13000           13000                                                                                                                                                         
Curtis          1997       3100            6000                                                                                                                                                         
Pat             1997       6000            6000                                                                                                                                                         
Randall         1998       2600            8600                                                                                                                                                         
Peter           1998       2500            8600                                                                                                                                                         
Jonathon        1998       8600            8600                                                                                                                                                         
Diana           1999       4200            7000                                                                                                                                                         
Kevin           1999       5800            7000                                                                                                                                                         
Kimerely        1999       7000            7000                                                                                                                                                         
Eleni           2000      10500           10500                                                                                                                                                         

20 rows selected.

SQL> REM FIRST_NAME , HIRE_YEAR , SALARY , YEAR_MAX_SALARY
SQL> 
SQL> SELECT FIRST_NAME , HIRE_YEAR , SALARY , YEAR_MAX_SALARY
  2  FROM (SELECT FIRST_NAME , TO_CHAR(HIRE_DATE,'RRRR') HIRE_YEAR , SALARY FROM EMPLOYEES)
  3  JOIN (SELECT TO_CHAR(HIRE_DATE,'RRRR') HIRE_YEAR , MAX(SALARY) YEAR_MAX_SALARY FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'RRRR')) USING (HIRE_YEAR)
  4  ORDER BY 2;

FIRST_NAME      HIRE     SALARY YEAR_MAX_SALARY                                                                                                                                                         
--------------- ---- ---------- ---------------                                                                                                                                                         
Steven          1987      24000           24000                                                                                                                                                         
Jennifer        1987       4400           24000                                                                                                                                                         
Neena           1989      17000           17000                                                                                                                                                         
Alexander       1990       9000            9000                                                                                                                                                         
Bruce           1991       6000            6000                                                                                                                                                         
Lex             1993      17000           17000                                                                                                                                                         
Shelley         1994      12000           12000                                                                                                                                                         
William         1994       8300           12000                                                                                                                                                         
Trenna          1995       3500            3500                                                                                                                                                         
Ellen           1996      11000           13000                                                                                                                                                         
Michael         1996      13000           13000                                                                                                                                                         
Curtis          1997       3100            6000                                                                                                                                                         
Pat             1997       6000            6000                                                                                                                                                         
Randall         1998       2600            8600                                                                                                                                                         
Peter           1998       2500            8600                                                                                                                                                         
Jonathon        1998       8600            8600                                                                                                                                                         
Diana           1999       4200            7000                                                                                                                                                         
Kevin           1999       5800            7000                                                                                                                                                         
Kimerely        1999       7000            7000                                                                                                                                                         
Eleni           2000      10500           10500                                                                                                                                                         

20 rows selected.

SQL> SELECT FIRST_NAME , HIRE_YEAR , SALARY , YEAR_MAX_SALARY
  2  FROM (SELECT FIRST_NAME , TO_CHAR(HIRE_DATE,'RRRR') HIRE_YEAR , SALARY FROM EMPLOYEES) E
  3  JOIN (SELECT TO_CHAR(HIRE_DATE,'RRRR') HIRE_YEAR , MAX(SALARY) YEAR_MAX_SALARY FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'RRRR')) S
  4  ON E.HIRE_YEAR = S.HIRE_YEAR
  5  ORDER BY 2;
SELECT FIRST_NAME , HIRE_YEAR , SALARY , YEAR_MAX_SALARY
                    *
ERROR at line 1:
ORA-00918: column ambiguously defined 


SQL> SELECT FIRST_NAME , E.HIRE_YEAR , SALARY , YEAR_MAX_SALARY
  2  FROM (SELECT FIRST_NAME , TO_CHAR(HIRE_DATE,'RRRR') HIRE_YEAR , SALARY FROM EMPLOYEES) E
  3  JOIN (SELECT TO_CHAR(HIRE_DATE,'RRRR') HIRE_YEAR , MAX(SALARY) YEAR_MAX_SALARY FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'RRRR')) S
  4  ON E.HIRE_YEAR = S.HIRE_YEAR
  5  ORDER BY 2;

FIRST_NAME      HIRE     SALARY YEAR_MAX_SALARY                                                                                                                                                         
--------------- ---- ---------- ---------------                                                                                                                                                         
Jennifer        1987       4400           24000                                                                                                                                                         
Steven          1987      24000           24000                                                                                                                                                         
Neena           1989      17000           17000                                                                                                                                                         
Alexander       1990       9000            9000                                                                                                                                                         
Bruce           1991       6000            6000                                                                                                                                                         
Lex             1993      17000           17000                                                                                                                                                         
Shelley         1994      12000           12000                                                                                                                                                         
William         1994       8300           12000                                                                                                                                                         
Trenna          1995       3500            3500                                                                                                                                                         
Ellen           1996      11000           13000                                                                                                                                                         
Michael         1996      13000           13000                                                                                                                                                         
Curtis          1997       3100            6000                                                                                                                                                         
Pat             1997       6000            6000                                                                                                                                                         
Randall         1998       2600            8600                                                                                                                                                         
Peter           1998       2500            8600                                                                                                                                                         
Jonathon        1998       8600            8600                                                                                                                                                         
Kevin           1999       5800            7000                                                                                                                                                         
Kimerely        1999       7000            7000                                                                                                                                                         
Diana           1999       4200            7000                                                                                                                                                         
Eleni           2000      10500           10500                                                                                                                                                         

20 rows selected.

SQL> REM FIRST_NAME , DEPARTMENT_ID , SALARY , DEPT_MAX_SAL , DIFFERENCE
SQL> 
SQL> SELECT FIRST_NAME, DEPARTMENT_ID , SALARY , DEPT_MAX_SAL , DEPT_MAX_SAL - SALARY DIFFERENCE
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MAX(SALARY) DEPT_MAX_SAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME      DEPARTMENT_ID     SALARY DEPT_MAX_SAL DIFFERENCE                                                                                                                                        
--------------- ------------- ---------- ------------ ----------                                                                                                                                        
Steven                     90      24000        24000          0                                                                                                                                        
Neena                      90      17000        24000       7000                                                                                                                                        
Lex                        90      17000        24000       7000                                                                                                                                        
Alexander                  60       9000         9000          0                                                                                                                                        
Bruce                      60       6000         9000       3000                                                                                                                                        
Diana                      60       4200         9000       4800                                                                                                                                        
Kevin                      50       5800         5800          0                                                                                                                                        
Trenna                     50       3500         5800       2300                                                                                                                                        
Curtis                     50       3100         5800       2700                                                                                                                                        
Randall                    50       2600         5800       3200                                                                                                                                        
Peter                      50       2500         5800       3300                                                                                                                                        
Eleni                      80      10500        11000        500                                                                                                                                        
Ellen                      80      11000        11000          0                                                                                                                                        
Jonathon                   80       8600        11000       2400                                                                                                                                        
Jennifer                   10       4400         4400          0                                                                                                                                        
Michael                    20      13000        13000          0                                                                                                                                        
Pat                        20       6000        13000       7000                                                                                                                                        
Shelley                   110      12000        12000          0                                                                                                                                        
William                   110       8300        12000       3700                                                                                                                                        

19 rows selected.

SQL> REM LAST_NAME , JOB_ID , SALARY , JOB_SUM_SAL , "% OF SUM SAL"
SQL> 
SQL> REM IT_PROG : 5000 + 6000 + 7000 = 18000 -> 33.33%
SQL> 
SQL> SELECT LAST_NAME , JOB_ID , SALARY , JOB_SUM_SAL , "% OF SUM SAL"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT JOB_ID , SUM(SALARY) JOB_SUM_SAL FROM EMPLOYEES GROUP BY JOB_ID)
  4  ORDER BY 2
  5  
SQL> 
SQL> 
SQL> SELECT LAST_NAME , JOB_ID , SALARY , JOB_SUM_SAL , TO_CHAR(SALARY*100/JOB_SUM_SAL,'999.99%') "% OF SUM SAL"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT JOB_ID , SUM(SALARY) JOB_SUM_SAL FROM EMPLOYEES GROUP BY JOB_ID)
  4  ORDER BY 2;
SELECT LAST_NAME , JOB_ID , SALARY , JOB_SUM_SAL , TO_CHAR(SALARY*100/JOB_SUM_SAL,'999.99%') "% OF SUM SAL"
                                                                                  *
ERROR at line 1:
ORA-01481: invalid number format model 


SQL> SELECT LAST_NAME , JOB_ID , SALARY , JOB_SUM_SAL , TO_CHAR(SALARY*100/JOB_SUM_SAL,'999.99')||'%' "% OF SUM SAL"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT JOB_ID , SUM(SALARY) JOB_SUM_SAL FROM EMPLOYEES GROUP BY JOB_ID)
  4  ORDER BY 2;

LAST_NAME       JOB_ID         SALARY JOB_SUM_SAL % OF SUM                                                                                                                                              
--------------- ---------- ---------- ----------- --------                                                                                                                                              
Gietz           AC_ACCOUNT       8300        8300  100.00%                                                                                                                                              
Higgins         AC_MGR          12000       12000  100.00%                                                                                                                                              
Whalen          AD_ASST          4400        4400  100.00%                                                                                                                                              
King            AD_PRES         24000       24000  100.00%                                                                                                                                              
Kochhar         AD_VP           17000       34000   50.00%                                                                                                                                              
De Haan         AD_VP           17000       34000   50.00%                                                                                                                                              
Hunold          IT_PROG          9000       19200   46.88%                                                                                                                                              
Ernst           IT_PROG          6000       19200   31.25%                                                                                                                                              
Lorentz         IT_PROG          4200       19200   21.88%                                                                                                                                              
Hartstein       MK_MAN          13000       13000  100.00%                                                                                                                                              
Fay             MK_REP           6000        6000  100.00%                                                                                                                                              
Zlotkey         SA_MAN          10500       10500  100.00%                                                                                                                                              
Abel            SA_REP          11000       26600   41.35%                                                                                                                                              
Taylor          SA_REP           8600       26600   32.33%                                                                                                                                              
Grant           SA_REP           7000       26600   26.32%                                                                                                                                              
Rajs            ST_CLERK         3500       11700   29.91%                                                                                                                                              
Davies          ST_CLERK         3100       11700   26.50%                                                                                                                                              
Matos           ST_CLERK         2600       11700   22.22%                                                                                                                                              
Vargas          ST_CLERK         2500       11700   21.37%                                                                                                                                              
Mourgos         ST_MAN           5800        5800  100.00%                                                                                                                                              

20 rows selected.

SQL> REM FIRST_NAME , SALARY , DEPARTMENT_ID , DEPT_MIN_SAL , JOB_ID , JOB_AVG_SAL , MANAGER_ID , MGR_MAX_SAL
SQL> 
SQL> REM 1 NJ 2 IJ USING 3 IJ ON
SQL> 
SQL> SELECT DEPARTMENT_NAME , CITY , COUNTRY_NAME
  2  FROM DEPARTMENTA
  3  
SQL> SELECT DEPARTMENT_NAME , CITY , COUNTRY_NAME
  2  FROM DEPARTMENTS
  3  NATURAL JOIN LOCATIONS
  4  JOIN COUNTRIES USING (COUNTRY_ID);

DEPARTMENT_NAME                CITY                           COUNTRY_NAME                                                                                                                              
------------------------------ ------------------------------ ----------------------------------------                                                                                                  
Administration                 Seattle                        United States of America                                                                                                                  
Marketing                      Toronto                        Canada                                                                                                                                    
Shiping                        South San Francisco            United States of America                                                                                                                  
IT                             Southlake                      United States of America                                                                                                                  
Sales                          Oxford                         United Kingdom                                                                                                                            
Executive                      Seattle                        United States of America                                                                                                                  
Accounting                     Seattle                        United States of America                                                                                                                  
Contracting                    Seattle                        United States of America                                                                                                                  

8 rows selected.

SQL> SELECT DEPARTMENT_NAME , CITY , COUNTRY_NAME
  2  FROM DEPARTMENTS
  3  JOIN LOCATIONS USING (LOCATION_ID)
  4  NATURAL JOIN COUNTRIES;

DEPARTMENT_NAME                CITY                           COUNTRY_NAME                                                                                                                              
------------------------------ ------------------------------ ----------------------------------------                                                                                                  
Administration                 Seattle                        Canada                                                                                                                                    
Administration                 Seattle                        Germany                                                                                                                                   
Administration                 Seattle                        United Kingdom                                                                                                                            
Administration                 Seattle                        United States of America                                                                                                                  
Marketing                      Toronto                        Canada                                                                                                                                    
Marketing                      Toronto                        Germany                                                                                                                                   
Marketing                      Toronto                        United Kingdom                                                                                                                            
Marketing                      Toronto                        United States of America                                                                                                                  
Shiping                        South San Francisco            Canada                                                                                                                                    
Shiping                        South San Francisco            Germany                                                                                                                                   
Shiping                        South San Francisco            United Kingdom                                                                                                                            
Shiping                        South San Francisco            United States of America                                                                                                                  
IT                             Southlake                      Canada                                                                                                                                    
IT                             Southlake                      Germany                                                                                                                                   
IT                             Southlake                      United Kingdom                                                                                                                            
IT                             Southlake                      United States of America                                                                                                                  
Sales                          Oxford                         Canada                                                                                                                                    
Sales                          Oxford                         Germany                                                                                                                                   
Sales                          Oxford                         United Kingdom                                                                                                                            
Sales                          Oxford                         United States of America                                                                                                                  
Executive                      Seattle                        Canada                                                                                                                                    

DEPARTMENT_NAME                CITY                           COUNTRY_NAME                                                                                                                              
------------------------------ ------------------------------ ----------------------------------------                                                                                                  
Executive                      Seattle                        Germany                                                                                                                                   
Executive                      Seattle                        United Kingdom                                                                                                                            
Executive                      Seattle                        United States of America                                                                                                                  
Accounting                     Seattle                        Canada                                                                                                                                    
Accounting                     Seattle                        Germany                                                                                                                                   
Accounting                     Seattle                        United Kingdom                                                                                                                            
Accounting                     Seattle                        United States of America                                                                                                                  
Contracting                    Seattle                        Canada                                                                                                                                    
Contracting                    Seattle                        Germany                                                                                                                                   
Contracting                    Seattle                        United Kingdom                                                                                                                            
Contracting                    Seattle                        United States of America                                                                                                                  

32 rows selected.

SQL> REM FIRST_NAME , SALARY , DEPARTMENT_ID , DEPT_MIN_SAL , JOB_ID , JOB_AVG_SAL , MANAGER_ID , MGR_MAX_SAL
SQL> 
SQL> REM 1 NJ 2 IJ USING 3 IJ ON
SQL> 
SQL> SELECT FIRST_NAME , SALARY , DEPARTMENT_ID , DEPT_MIN_SAL , JOB_ID , JOB_AVG_SAL , MANAGER_ID , MGR_MAX_SAL
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) DEPT_MIN_SAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID)
  4  NATURAL JOIN (SELECT JOB_ID , AVG(SALARY) JOB_AVG_SAL FROM EMPLOYEES GROUP BY JOB_ID)
  5  NATURAL JOIN (SELECT MANAGER_ID , MAX(SALARY) MANAGER_MAX_SAL FROM EMPLOYEES GROUP BY MANAGER_ID);
SELECT FIRST_NAME , SALARY , DEPARTMENT_ID , DEPT_MIN_SAL , JOB_ID , JOB_AVG_SAL , MANAGER_ID , MGR_MAX_SAL
                                                                                                *
ERROR at line 1:
ORA-00904: "MGR_MAX_SAL": invalid identifier 


SQL> SELECT FIRST_NAME , SALARY , DEPARTMENT_ID , DEPT_MIN_SAL , JOB_ID , JOB_AVG_SAL , MANAGER_ID , MGR_MAX_SAL
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) DEPT_MIN_SAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID)
  4  NATURAL JOIN (SELECT JOB_ID , AVG(SALARY) JOB_AVG_SAL FROM EMPLOYEES GROUP BY JOB_ID)
  5  NATURAL JOIN (SELECT MANAGER_ID , MAX(SALARY) MGR_MAX_SAL FROM EMPLOYEES GROUP BY MANAGER_ID);

FIRST_NAME          SALARY DEPARTMENT_ID DEPT_MIN_SAL JOB_ID     JOB_AVG_SAL MANAGER_ID MGR_MAX_SAL                                                                                                     
--------------- ---------- ------------- ------------ ---------- ----------- ---------- -----------                                                                                                     
Alexander             9000            60         4200 IT_PROG           6400        102        9000                                                                                                     
Bruce                 6000            60         4200 IT_PROG           6400        103        6000                                                                                                     
Diana                 4200            60         4200 IT_PROG           6400        103        6000                                                                                                     
Shelley              12000           110         8300 AC_MGR           12000        101       12000                                                                                                     
William               8300           110         8300 AC_ACCOUNT        8300        205        8300                                                                                                     
Kevin                 5800            50         2500 ST_MAN            5800        100       17000                                                                                                     
Jennifer              4400            10         4400 AD_ASST           4400        101       12000                                                                                                     
Neena                17000            90        17000 AD_VP            17000        100       17000                                                                                                     
Lex                  17000            90        17000 AD_VP            17000        100       17000                                                                                                     
Eleni                10500            80         8600 SA_MAN           10500        100       17000                                                                                                     
Michael              13000            20         6000 MK_MAN           13000        100       17000                                                                                                     
Ellen                11000            80         8600 SA_REP      8866~66667        149       11000                                                                                                     
Jonathon              8600            80         8600 SA_REP      8866~66667        149       11000                                                                                                     
Pat                   6000            20         6000 MK_REP            6000        201        6000                                                                                                     
Trenna                3500            50         2500 ST_CLERK          2925        124        3500                                                                                                     
Curtis                3100            50         2500 ST_CLERK          2925        124        3500                                                                                                     
Randall               2600            50         2500 ST_CLERK          2925        124        3500                                                                                                     
Peter                 2500            50         2500 ST_CLERK          2925        124        3500                                                                                                     

18 rows selected.

SQL> SELECT FIRST_NAME , SALARY , DEPARTMENT_ID , DEPT_MIN_SAL , JOB_ID , JOB_AVG_SAL , MANAGER_ID , MGR_MAX_SAL
  2  FROM EMPLOYEES
  3  JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) DEPT_MIN_SAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID) USING (DEPARTMENT_ID)
  4  JOIN (SELECT JOB_ID , AVG(SALARY) JOB_AVG_SAL FROM EMPLOYEES GROUP BY JOB_ID) USING (JOB_ID)
  5  JOIN (SELECT MANAGER_ID , MAX(SALARY) MGR_MAX_SAL FROM EMPLOYEES GROUP BY MANAGER_ID) USING (MANAGER_ID);

FIRST_NAME          SALARY DEPARTMENT_ID DEPT_MIN_SAL JOB_ID     JOB_AVG_SAL MANAGER_ID MGR_MAX_SAL                                                                                                     
--------------- ---------- ------------- ------------ ---------- ----------- ---------- -----------                                                                                                     
Alexander             9000            60         4200 IT_PROG           6400        102        9000                                                                                                     
Bruce                 6000            60         4200 IT_PROG           6400        103        6000                                                                                                     
Diana                 4200            60         4200 IT_PROG           6400        103        6000                                                                                                     
Shelley              12000           110         8300 AC_MGR           12000        101       12000                                                                                                     
William               8300           110         8300 AC_ACCOUNT        8300        205        8300                                                                                                     
Kevin                 5800            50         2500 ST_MAN            5800        100       17000                                                                                                     
Jennifer              4400            10         4400 AD_ASST           4400        101       12000                                                                                                     
Neena                17000            90        17000 AD_VP            17000        100       17000                                                                                                     
Lex                  17000            90        17000 AD_VP            17000        100       17000                                                                                                     
Eleni                10500            80         8600 SA_MAN           10500        100       17000                                                                                                     
Michael              13000            20         6000 MK_MAN           13000        100       17000                                                                                                     
Ellen                11000            80         8600 SA_REP      8866~66667        149       11000                                                                                                     
Jonathon              8600            80         8600 SA_REP      8866~66667        149       11000                                                                                                     
Pat                   6000            20         6000 MK_REP            6000        201        6000                                                                                                     
Trenna                3500            50         2500 ST_CLERK          2925        124        3500                                                                                                     
Curtis                3100            50         2500 ST_CLERK          2925        124        3500                                                                                                     
Randall               2600            50         2500 ST_CLERK          2925        124        3500                                                                                                     
Peter                 2500            50         2500 ST_CLERK          2925        124        3500                                                                                                     

18 rows selected.

SQL> SELECT FIRST_NAME , SALARY , E.DEPARTMENT_ID , DEPT_MIN_SAL , E.JOB_ID , JOB_AVG_SAL , E.MANAGER_ID , MGR_MAX_SAL
  2  FROM EMPLOYEES E
  3  JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) DEPT_MIN_SAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID) D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
  4  JOIN (SELECT JOB_ID , AVG(SALARY) JOB_AVG_SAL FROM EMPLOYEES GROUP BY JOB_ID) J ON E.JOB_ID = J.JOB_ID
  5  JOIN (SELECT MANAGER_ID , MAX(SALARY) MGR_MAX_SAL FROM EMPLOYEES GROUP BY MANAGER_ID) M ON E.MANAGER_ID = M.MANAGER_ID;

FIRST_NAME          SALARY DEPARTMENT_ID DEPT_MIN_SAL JOB_ID     JOB_AVG_SAL MANAGER_ID MGR_MAX_SAL                                                                                                     
--------------- ---------- ------------- ------------ ---------- ----------- ---------- -----------                                                                                                     
Alexander             9000            60         4200 IT_PROG           6400        102        9000                                                                                                     
Bruce                 6000            60         4200 IT_PROG           6400        103        6000                                                                                                     
Diana                 4200            60         4200 IT_PROG           6400        103        6000                                                                                                     
Shelley              12000           110         8300 AC_MGR           12000        101       12000                                                                                                     
William               8300           110         8300 AC_ACCOUNT        8300        205        8300                                                                                                     
Kevin                 5800            50         2500 ST_MAN            5800        100       17000                                                                                                     
Jennifer              4400            10         4400 AD_ASST           4400        101       12000                                                                                                     
Neena                17000            90        17000 AD_VP            17000        100       17000                                                                                                     
Lex                  17000            90        17000 AD_VP            17000        100       17000                                                                                                     
Eleni                10500            80         8600 SA_MAN           10500        100       17000                                                                                                     
Michael              13000            20         6000 MK_MAN           13000        100       17000                                                                                                     
Ellen                11000            80         8600 SA_REP      8866~66667        149       11000                                                                                                     
Jonathon              8600            80         8600 SA_REP      8866~66667        149       11000                                                                                                     
Pat                   6000            20         6000 MK_REP            6000        201        6000                                                                                                     
Trenna                3500            50         2500 ST_CLERK          2925        124        3500                                                                                                     
Curtis                3100            50         2500 ST_CLERK          2925        124        3500                                                                                                     
Randall               2600            50         2500 ST_CLERK          2925        124        3500                                                                                                     
Peter                 2500            50         2500 ST_CLERK          2925        124        3500                                                                                                     

18 rows selected.

SQL> SPOOL OFF
